const _0x468e=['http://119.29.118.238:6690/generate-stream','已关闭画图撤回','\x0a步数：','group','isMaster','#关闭代理','json','Bearer','#以图生草','get','我没画成功，再来一次吧。','步数不在合理范围内，28以下为合理范围','已开启画图冷却，冷却时间为30秒','\x0a降噪：','msg','包含中文','访问成功了','没有访问成功哦','includes','土块AI绘个图','文件写入成功！','模型已设置为k_euler_ancestral','#土块画图预设','你还不能使用此功能哦，暂未激活。','#土块画图撤回','#开启默认屏蔽词','test','utf-8','对不起，你不可画哦','#以图生草降噪','我在cd中，还有','请发送图片','kqdl','random','round','lowres,\x20bad\x20anatomy,\x20bad\x20hands,\x20text,\x20error,\x20missing\x20fingers,\x20extra\x20digit,\x20fewer\x20digits,\x20cropped,\x20worst\x20quality,\x20low\x20quality,\x20normal\x20quality,\x20jpeg\x20artifacts,\x20signature,\x20watermark,\x20username,\x20blurry','toString','http','秒可画','log','stringify','k_euler_ancestral','以图生草','删除屏蔽词成功','readFile','abc','isGroup','已开启参数显示','k_lms','name','#关闭词条回复','./resources/th.txt','shuju','正在查看魔法，请稍后啊，0v0','parse','ddim','已取消当前画图','已关闭代理','user_id','message_id','没有访问成功,尝试换接口','^#查看所有预设$|#新增预设(.*)|(.*)','text','规模不在合理范围内，3-12为合理范围','k_euler','isPrivate','http://119.29.118.238:6690/generate-stream\x20','\x20http://www.iinside.cn:7001/api_req?reqmode=nmt_mt5_jez&password=3652&text=','code','#新增预设','./5.png','replace','#查看所有模型','^#以图生草(.*)$|(.*)','pbc','#土块画图涩涩开启','getTime','#土块画图冷却','规模已设置为','img','当前降噪','写入文件成功','szbs','proxyAddress','#新增屏蔽词','cwd','#查看预设','#开启代理','node-machine-id','好的，权限已经关闭，只有你能画了','\x20\x20\x20|规模:','模型已设置为k_euler','写入文件错误','魔法是：','模型:','application/json','你是主人，没有cd，欸嘿','模型已设置为plms','base64','image','post','[\x5cu4E00-\x5cu9FFF]+','Steps','Mozilla/5.0\x20(Windows\x20NT\x206.1;\x20WOW64)\x20AppleWebKit/537.36\x20(KHTML,\x20like\x20Gecko)\x20Chrome/86.0.4240.198\x20Safari/537.36','\x20\x20\x20\x20\x20\x20\x20\x20|seed:','成功了！','好的，已关闭了','模型已设置为ddim','fanyi','data','nai-diffusion','writeFile','暂未激活该功能哦','masterpiece,\x20best\x20quality,','concat','#删除预设','/3.jpg','recallMsg','正在画图中，我知道你很急，但是你先别急。','default','then','你不是主人，不能用预设哦','szmx','writeFileSync','reply','szgm','/5.png','模型已设置为k_lms','trim','https://api.novelai.net/ai/generate-image\x20','floor','预设包含中文','huatu3','qvht','步数已设置为','#开启参数显示','split','已关闭词条回复','^#土块画图规模(.*)','length','None','https-proxy-agent','没有访问成功','error','#取消画图','/plugins/earth-k-plugin/resources/htys/ys.json','当前屏蔽词有：'];const _0x3867=function(_0x468e6b,_0x38675c){_0x468e6b=_0x468e6b-0x0;let _0x3fa9c7=_0x468e[_0x468e6b];return _0x3fa9c7;};import{segment}from'oicq';import _0x5a9ca0 from'node-fetch';import _0x1a0ee0,{chownSync}from'fs';import _0xb91428 from'../../../lib/config/config.js';import _0x216424 from'../../../lib/puppeteer/puppeteer.js';let data1={};import{createRequire}from'module';const require=createRequire(import.meta['url']);let ysct;let mf;let mfkg=0x0;let ml=process[_0x3867('0x55')]();var http=require(_0x3867('0x25'));import _0x4a79d3 from'lodash';let yushekg=0x0;let kg=0x0;let guimo=5.5;let kg2=0x0;let mfid='';let res4;let htm='';let htm2='';let res5;let res;let zr=0x0;let changdu=0x200;let kuandu=0x200;let msg2;let timeout=0x7530;let isch=0x1;let cd=0x0;let t;let startTimeMS;let iscd=0x0;let my;let dz;let sj1;let sj2;let shuju;let zt=0x0;let gjc2;let sc=0x0;let bushu=0x1c;let id='';let xsd=0.4;let nr;let ycqx;let jz=0.2;let ss='nai-diffusion';let Path;let ys=[];let moxing=_0x3867('0x40');let isdl=0x0;let iscanshu=0x1;let ishuifu=!![];let HttpsProxyAgent='';let pc='lowres,nude,\x20bad\x20anatomy,\x20bad\x20hands,\x20text,\x20error,\x20missing\x20fingers,\x20extra\x20digit,\x20fewer\x20digits,\x20cropped,\x20worst\x20quality,\x20low\x20quality,\x20normal\x20quality,\x20jpeg\x20artifacts,\x20signature,\x20watermark,\x20username,\x20blurry,\x20owres,\x20bad\x20anatomy,\x20bad\x20hands,\x20text,\x20error,\x20missing\x20fingers,\x20extra\x20digit,\x20fewer\x20digits,\x20cropped,\x20worst\x20quality,\x20low\x20quality,\x20normal\x20quality,\x20jpeg\x20artifacts,\x20signature,\x20watermark,\x20username,\x20blurry';export class aiht extends plugin{constructor(){super({'name':_0x3867('0x13'),'dsc':_0x3867('0x13'),'event':'message','priority':0x479,'rule':[{'reg':'^#绘个图(.*)$|#土块画图预设(.*)$','fnc':'huatu2'},{'reg':'^#取消画图$|^#所有人可画$|^#仅我可画$|^#土块画图撤回(.*)$|^#土块画图冷却(.*)$|^#土块画图涩涩开启|^#土块画图涩涩关闭','fnc':_0x3867('0x85')},{'reg':'^#新增屏蔽词(.*)$|#查看屏蔽词$|#删除屏蔽词$|#开启默认屏蔽词$','fnc':_0x3867('0x4a')},{'reg':_0x3867('0x49'),'fnc':'huatu3','log':![]},{'reg':_0x3867('0x3d'),'fnc':'ysgn','log':![]},{'reg':_0x3867('0x8a'),'fnc':_0x3867('0x7d')},{'reg':'^#土块画图模型(.*)|^#查看所有模型','fnc':_0x3867('0x7a')},{'reg':'^#土块画图步数(.*)|^#查看画图设置','fnc':_0x3867('0x52')},{'reg':'^#开启代理|^#关闭代理|^#开启参数显示|^#关闭参数显示|^#开启词条回复|^#关闭词条回复','fnc':_0x3867('0x20')}]});}async['kqdl'](_0x3e87f0){if(_0x3e87f0['msg']==_0x3867('0x57')&_0x3e87f0['isMaster']){isdl=0x1;_0x3e87f0[_0x3867('0x7c')]('开启代理成功');}if(_0x3e87f0['msg']==_0x3867('0x5')&_0x3e87f0[_0x3867('0x4')]){isdl=0x0;_0x3e87f0[_0x3867('0x7c')](_0x3867('0x39'));}if(_0x3e87f0['msg']==_0x3867('0x87')&_0x3e87f0[_0x3867('0x4')]){iscanshu=0x1;_0x3e87f0['reply'](_0x3867('0x2f'));}if(_0x3e87f0['msg']=='#关闭参数显示'&_0x3e87f0[_0x3867('0x4')]){iscanshu=0x0;_0x3e87f0['reply']('已关闭参数显示');}if(_0x3e87f0['msg']=='#开启词条回复'&_0x3e87f0[_0x3867('0x4')]){ishuifu=!![];_0x3e87f0['reply']('已开启词条回复');}if(_0x3e87f0[_0x3867('0xe')]==_0x3867('0x32')&_0x3e87f0['isMaster']){ishuifu=![];_0x3e87f0[_0x3867('0x7c')](_0x3867('0x89'));}}async['szbs'](_0x3c274c){if(_0x3c274c['msg']=='#查看画图设置'){console['log'](guimo);let _0x417bb4=['模型：',moxing,'\x0a规模：',guimo['toString'](),_0x3867('0x2'),bushu['toString'](),'\x0a相似度：',xsd[_0x3867('0x24')](),_0x3867('0xd'),jz[_0x3867('0x24')]()];_0x3c274c[_0x3867('0x7c')](_0x417bb4);return;}bushu=_0x3c274c[_0x3867('0xe')][_0x3867('0x47')](/#土块画图步数/g,'')[_0x3867('0x80')]();bushu=Number(bushu);if(bushu<0x0|bushu>0x1c){bushu=0x1c;_0x3c274c['reply'](_0x3867('0xb'));return;}else{_0x3c274c['reply'](_0x3867('0x86')+String(bushu));}}async['szmx'](_0x1aa9ce){if(_0x1aa9ce[_0x3867('0xe')]==_0x3867('0x48')){let _0x517b34=['1：k_euler_ancestral,\x0a2：k_euler,\x0a3：k_lms,\x0a4：plms,\x0a5：ddim'];_0x1aa9ce['reply'](_0x517b34);return;}moxing=_0x1aa9ce['msg']['replace'](/#土块画图模型/g,'')['trim']();moxing=Number(moxing);if(moxing<0x0|moxing>0x5){_0x1aa9ce['reply']('模型不在合理范围内，1-5为合理范围');moxing=0x2;return;}if(moxing==0x1){moxing='k_euler_ancestral';_0x1aa9ce['reply'](_0x3867('0x15'));}if(moxing==0x2){moxing='k_euler';_0x1aa9ce[_0x3867('0x7c')](_0x3867('0x5b'));}if(moxing==0x3){moxing=_0x3867('0x30');_0x1aa9ce['reply'](_0x3867('0x7f'));}if(moxing==0x4){moxing='plms';_0x1aa9ce['reply'](_0x3867('0x61'));}if(moxing==0x5){moxing=_0x3867('0x37');_0x1aa9ce['reply'](_0x3867('0x6b'));}}async[_0x3867('0x7d')](_0x5a371a){guimo=_0x5a371a['msg']['replace'](/#土块画图规模/g,'')['trim']();guimo=Number(guimo);if(guimo<0x3|guimo>0xc){_0x5a371a[_0x3867('0x7c')](_0x3867('0x3f'));guimo=5.5;return;}else{_0x5a371a[_0x3867('0x7c')](_0x3867('0x4e')+String(guimo));}}async['ysgn'](_0x206785){if(_0x206785['img']!=undefined){return![];}if(yushekg==0x0&_0x206785['msg']['includes'](_0x3867('0x56'))==![]&_0x206785[_0x3867('0xe')]['includes'](_0x3867('0x45'))==![]&_0x206785[_0x3867('0xe')]['includes']('#删除预设')==![]&_0x206785['msg']['includes']('#查看预设词条')==![]){return![];}let _0x5860ba=ml+'/plugins/earth-k-plugin/resources/htys/ys.json';let _0x2f7839='';await _0x1a0ee0[_0x3867('0x2c')](_0x5860ba,(_0x241786,_0x13fa00)=>{if(_0x241786)throw _0x241786;var _0x2d1121=_0x13fa00[_0x3867('0x24')]()!=''?JSON[_0x3867('0x36')](_0x13fa00['toString']()):[];ysct='';_0x2f7839='';shuju=_0x2d1121;for(let _0x4ffcc0=0x0;_0x4ffcc0<shuju[_0x3867('0x34')][_0x3867('0x8b')];_0x4ffcc0++){_0x2f7839=_0x2f7839+shuju[_0x3867('0x34')][_0x4ffcc0][_0x3867('0x31')]+',';ysct=ysct+shuju['shuju'][_0x4ffcc0]['gjc']+'++';}});await sleep(0x1f4);if(_0x206785['msg'][_0x3867('0x12')]('#查看预设词条')&_0x206785[_0x3867('0x4')]){let _0x56e8f4=_0x206785[_0x3867('0xe')]['replace'](/#查看预设词条/g,'')[_0x3867('0x80')]();_0x56e8f4=Number(_0x56e8f4);ysct=ysct['split']('++');_0x2f7839=_0x2f7839[_0x3867('0x88')](',');if(_0x56e8f4>ysct['length']|_0x56e8f4<0x0){_0x206785[_0x3867('0x7c')]('数字超过了预设个数');return;}_0x206785[_0x3867('0x7c')]([_0x2f7839[_0x56e8f4-0x1],':',ysct[_0x56e8f4-0x1]]);ysct='';_0x2f7839='';}if(_0x206785['msg']==_0x3867('0x56')&_0x206785[_0x3867('0x4')]){_0x2f7839=_0x2f7839['split'](',');data1={'tplFile':'./plugins/earth-k-plugin/resources/aiht/ml.html','dz':ml,'lb':_0x2f7839,'qsid':0x0};let _0x5b2bc0=await _0x216424['screenshot']('123',{...data1});_0x206785['reply'](_0x5b2bc0);return;_0x206785['reply']('当前预设有：\x0a'+_0x2f7839);}if(_0x206785['msg']['includes'](_0x3867('0x73'))&_0x206785['isMaster']){let _0x5e99b3=_0x206785['msg'][_0x3867('0x47')](/#删除预设/g,'')[_0x3867('0x80')]();_0x5e99b3=Number(_0x5e99b3);if(_0x5e99b3<shuju['shuju'][_0x3867('0x8b')]+0x1){shuju[_0x3867('0x34')]['splice'](_0x5e99b3-0x1,0x1);var _0x1c4628=JSON[_0x3867('0x28')](shuju);}_0x1a0ee0[_0x3867('0x6f')](_0x5860ba,_0x1c4628,function(_0x3512a5){if(_0x3512a5){console[_0x3867('0x8f')](_0x3512a5);}_0x206785[_0x3867('0x7c')]('删除预设成功');});}if(_0x206785[_0x3867('0xe')][_0x3867('0x12')](_0x3867('0x45'))&_0x206785['isMaster']&yushekg==0x0){yushekg=0x1;ys[0x0]=_0x206785['msg']['replace'](/#新增预设/g,'')[_0x3867('0x80')]();_0x206785['reply']('请添加预设关键词');return;}if(yushekg==0x1&_0x206785['isMaster']){yushekg=0x0;ys[0x1]=_0x206785['msg'];let _0x140621={'name':ys[0x0],'gjc':ys[0x1]};shuju[_0x3867('0x34')]['push'](_0x140621);console['log'](shuju);var _0x1c4628=JSON['stringify'](shuju);_0x1a0ee0['writeFile'](_0x5860ba,_0x1c4628,_0x20fc89=>{if(_0x20fc89)throw _0x20fc89;console['log'](_0x3867('0x14'));_0x206785[_0x3867('0x7c')]('新增预设成功');});return;}}async[_0x3867('0x4a')](_0x5d753a){if(_0x5d753a[_0x3867('0xe')]['includes'](_0x3867('0x54'))&_0x5d753a[_0x3867('0x4')]){_0x5d753a['reply']('新增屏蔽词成功');pc=_0x5d753a[_0x3867('0xe')]['replace'](/#新增屏蔽词/g,'')[_0x3867('0x80')]();}if(_0x5d753a[_0x3867('0xe')]=='#查看屏蔽词'&_0x5d753a[_0x3867('0x4')]){_0x5d753a['reply']([_0x3867('0x92'),pc]);}if(_0x5d753a['msg']['includes']('#删除屏蔽词')&_0x5d753a['isMaster']){_0x5d753a[_0x3867('0x7c')](_0x3867('0x2b')+'我知道你要干嘛！注意身体！');pc='';}if(_0x5d753a['msg']['includes'](_0x3867('0x19'))&_0x5d753a['isMaster']){_0x5d753a[_0x3867('0x7c')]('已经开启默认屏蔽词');pc='lowres,nude,\x20bad\x20anatomy,\x20bad\x20hands,\x20text,\x20error,\x20missing\x20fingers,\x20extra\x20digit,\x20fewer\x20digits,\x20cropped,\x20worst\x20quality,\x20low\x20quality,\x20normal\x20quality,\x20jpeg\x20artifacts,\x20signature,\x20watermark,\x20username,\x20blurry,\x20owres,\x20bad\x20anatomy,\x20bad\x20hands,\x20text,\x20error,\x20missing\x20fingers,\x20extra\x20digit,\x20fewer\x20digits,\x20cropped,\x20worst\x20quality,\x20low\x20quality,\x20normal\x20quality,\x20jpeg\x20artifacts,\x20signature,\x20watermark,\x20username,\x20blurry';}}async['qvht'](_0x472adf){if(_0x472adf[_0x3867('0xe')]==_0x3867('0x4b')&_0x472adf[_0x3867('0x4')]){_0x472adf[_0x3867('0x7c')]('好的，已开启，请注意身体哦');ss=_0x3867('0x6e');}if(_0x472adf[_0x3867('0xe')]=='#土块画图涩涩关闭'&_0x472adf[_0x3867('0x4')]){_0x472adf['reply'](_0x3867('0x6a'));ss='safe-diffusion';}await dqpz();if(_0x472adf['msg'][_0x3867('0x12')]('#土块画图冷却关闭')&_0x472adf[_0x3867('0x4')]){nr[0x3]=0x0;nr[0x0]=0x0;_0x1a0ee0['writeFileSync'](Path,nr['toString'](),'utf-8');cd=0x0;kg2=0x0;kg=0x0;sc=0x0;iscd=0x0;_0x472adf['reply']('已关闭画图冷却');return;}if(_0x472adf['msg'][_0x3867('0x12')]('#土块画图冷却开启')&_0x472adf['isMaster']){nr[0x0]=0x7530;nr[0x3]=0x1;_0x1a0ee0['writeFileSync'](Path,nr[_0x3867('0x24')](),_0x3867('0x1b'));cd=0x7530;_0x472adf['reply'](_0x3867('0xc'));return;}if(_0x472adf[_0x3867('0xe')][_0x3867('0x12')](_0x3867('0x4d'))&_0x472adf['isMaster']){let _0x56d7ab=_0x472adf['msg'][_0x3867('0x47')](/#土块画图冷却/g,'')[_0x3867('0x80')]();cd=Number(_0x56d7ab)*0x3e8;nr[0x0]=cd;nr[0x3]=0x1;_0x1a0ee0['writeFileSync'](Path,nr['toString'](),_0x3867('0x1b'));_0x472adf[_0x3867('0x7c')]('已设置冷却时间为'+_0x56d7ab+'秒');}if(_0x472adf['msg']['includes']('#土块画图撤回关闭')&_0x472adf[_0x3867('0x4')]){nr[0x2]=0x0;_0x1a0ee0[_0x3867('0x7b')](Path,nr['toString'](),_0x3867('0x1b'));isch=0x0;_0x472adf['reply'](_0x3867('0x1'));return;}if(_0x472adf[_0x3867('0xe')][_0x3867('0x12')]('#土块画图撤回开启')&_0x472adf[_0x3867('0x4')]){isch=0x1;nr[0x1]=0x7530;nr[0x2]=0x1;_0x1a0ee0['writeFileSync'](Path,nr[_0x3867('0x24')](),_0x3867('0x1b'));timeout=0x7530;_0x472adf['reply']('已开启画图撤回，撤回时间为30秒');return;}if(_0x472adf['msg']['includes'](_0x3867('0x18'))&_0x472adf['isMaster']){isch=0x1;let _0x3f9a43=_0x472adf['msg']['replace'](/#土块画图撤回/g,'')['trim']();timeout=Number(_0x3f9a43)*0x3e8;nr[0x1]=timeout;nr[0x2]=0x1;_0x1a0ee0['writeFileSync'](Path,nr['toString'](),_0x3867('0x1b'));_0x472adf[_0x3867('0x7c')]('已设置撤回时间为'+_0x3f9a43+'秒');}if(_0x472adf[_0x3867('0xe')]==_0x3867('0x90')){kg=0x0;sc=0x0;zt=0x0;id='';console[_0x3867('0x27')]('已经取消');kg2=0x0;_0x472adf['reply'](_0x3867('0x38'));}if(_0x472adf[_0x3867('0xe')]=='#所有人可画'&_0x472adf['isMaster']){_0x472adf[_0x3867('0x7c')]('好吧，那就一起来吧！');zr=0x0;}if(_0x472adf['msg']=='#仅我可画'&_0x472adf['isMaster']){_0x472adf['reply'](_0x3867('0x59'));zr=0x1;}}async[_0x3867('0x84')](_0x541d0a){if(_0x541d0a[_0x3867('0x4f')]!=undefined&zt==0x0&mfkg==0x0){return![];}if(_0x541d0a['img']==undefined&_0x541d0a['msg']!=undefined){if(_0x541d0a[_0x3867('0xe')]['includes'](_0x3867('0x8'))==![]&_0x541d0a[_0x3867('0x4f')]==undefined&zt==0x0&_0x541d0a['msg'][_0x3867('0x12')]('#查看魔法')==![]&mfkg==0x0){return![];}}if(mfkg==0x0&_0x541d0a[_0x3867('0xe')]=='#查看魔法'){mfkg=0x1;mfid=_0x541d0a['user_id'];_0x541d0a[_0x3867('0x7c')]('请发送要查看魔法的图片,0.0');mf=setTimeout(()=>{if(mfkg==0x1){mfkg=0x0;_0x541d0a[_0x3867('0x7c')]('15秒还未发图，查看魔法已取消');return;}},0x3a98);}if(_0x541d0a[_0x3867('0x4f')]!=undefined&mfkg==0x1&mfid==_0x541d0a[_0x3867('0x3a')]){clearTimeout(mf);_0x541d0a['reply'](_0x3867('0x35'));mfkg=0x0;mfid='';let _0x2f9e70='https://xiaobapi.top/api/xb/api/upload_image_tags.php?url=';console['log'](_0x541d0a['img']);_0x2f9e70=_0x2f9e70+_0x541d0a['img'][0x0];res=await _0x5a9ca0(_0x2f9e70,{'method':_0x3867('0x9'),'headers':{'Content-Type':'application/json','User-Agent':'Mozilla/5.0\x20(Windows\x20NT\x206.1;\x20WOW64)\x20AppleWebKit/537.36\x20(KHTML,\x20like\x20Gecko)\x20Chrome/86.0.4240.198\x20Safari/537.36'}});let _0x245536=await res['json']();console['log'](_0x3867('0x5d')+_0x245536);console[_0x3867('0x27')](_0x245536);if(_0x245536!=undefined){_0x541d0a['reply'](_0x245536['tags'],!![]);if(_0x245536[_0x3867('0x44')]==-0x1){_0x541d0a[_0x3867('0x7c')]('访问失败了,QAQ,TvT');mfkg=0x0;mfid='';}}else{}}if(_0x541d0a['img']==undefined&zt==0x1){return![];}if(_0x541d0a['img']==undefined&_0x541d0a[_0x3867('0xe')]!=undefined){dqpz();if(_0x541d0a[_0x3867('0xe')][_0x3867('0x12')]('#以图生草相似度')&_0x541d0a[_0x3867('0x4')]){xsd=Number(_0x541d0a[_0x3867('0xe')]['replace'](/#以图生草相似度/g,'')['trim']())/0x64;_0x541d0a[_0x3867('0x7c')]('当前相似度'+String(xsd));console['log'](xsd);return;}if(_0x541d0a[_0x3867('0xe')]['includes'](_0x3867('0x1d'))&_0x541d0a['isMaster']){jz=Number(_0x541d0a['msg'][_0x3867('0x47')](/#以图生草降噪/g,'')['trim']())/0x64;_0x541d0a['reply'](_0x3867('0x50')+String(jz));console[_0x3867('0x27')](jz);return;}if(zt==0x0&&sc==0x0&&_0x541d0a['msg']['includes'](_0x3867('0x8'))){if(_0x541d0a[_0x3867('0x41')]){_0x541d0a['reply']('以图生草暂不支持私聊');return;}dqpz();const {machineId,machineIdSync}=require(_0x3867('0x58'));htm=machineIdSync();try{htm2=_0x1a0ee0['readFileSync']('./resources/th.txt');}catch{_0x541d0a[_0x3867('0x7c')]('暂未激活该功能哦');return;}if(htm2==htm){htm2='';}htm2=htm2[_0x3867('0x24')]();htm2=htm2['replace'](/]Q/g,'a')[_0x3867('0x80')]();htm2=htm2['replace'](/\[W/g,'c')['trim']();htm2=htm2[_0x3867('0x47')](/\*T/g,'e')[_0x3867('0x80')]();htm2=htm2[_0x3867('0x47')](/\-R/g,'g')['trim']();htm2=htm2['replace'](/\*Z/g,'1')['trim']();htm2=htm2['replace'](/\+X/g,'2')['trim']();htm2=htm2[_0x3867('0x47')](/\-C/g,'3')['trim']();htm2=htm2[_0x3867('0x47')](/\)V/g,'4')[_0x3867('0x80')]();htm2=htm2['replace'](/\&Z/g,'9')[_0x3867('0x80')]();htm2=htm2[_0x3867('0x47')](/\^X/g,'8')['trim']();htm2=htm2['replace'](/\%C/g,'7')['trim']();htm2=htm2[_0x3867('0x47')](/\$V/g,'6')[_0x3867('0x80')]();if(htm!=htm2){_0x541d0a[_0x3867('0x7c')](_0x3867('0x17'));return;}console[_0x3867('0x27')](_0x3867('0x2a'));id=_0x541d0a[_0x3867('0x3a')];gjc2=_0x541d0a['msg']['replace'](/#以图生草/g,'')['trim']();var _0x47831d=new RegExp(_0x3867('0x65'),'g');if(_0x47831d[_0x3867('0x1a')](gjc2)){console[_0x3867('0x27')](_0x3867('0xf'));let _0x556a50='https://api.sdgou.cc/api/fanyi/?msg='+gjc2;let _0x30b006=await _0x5a9ca0(_0x556a50);let _0x3d9eda=await _0x30b006[_0x3867('0x3e')]();_0x3d9eda=_0x3d9eda[_0x3867('0x47')](/有道翻译查询结果/g,'')[_0x3867('0x80')]();_0x3d9eda=_0x3d9eda['replace'](/翻译后/g,'')[_0x3867('0x80')]();_0x3d9eda=_0x3d9eda[_0x3867('0x47')](/翻译前/g,'')['trim']();_0x3d9eda=_0x3d9eda['replace'](/：/g,'')['trim']();_0x3d9eda=_0x3d9eda['replace'](new RegExp(gjc2,'g'),'');gjc2=_0x3d9eda;console['log'](gjc2);}else{console['log']('是英文');}zt=0x1;ycqx=setTimeout(()=>{if(zt==0x1){zt=0x0;_0x541d0a[_0x3867('0x7c')]('30秒还未发图，以图生草已取消');return;}},0x7530);_0x541d0a['reply']([segment['at'](id),_0x3867('0x1f')]);return;}}if(sc==0x0&_0x541d0a[_0x3867('0x2e')]&zt==0x1&_0x541d0a['img']!=undefined){clearTimeout(ycqx);if(_0x541d0a[_0x3867('0x3a')]==id&zt==0x1){sc=0x1;let _0x576ca4=await imgUrlToBase64(_0x541d0a['img'][0x0]['replace'](/https/g,'http')[_0x3867('0x80')]());let _0x599958=_0x576ca4['base64Img'];let _0x384517=Math[_0x3867('0x82')](Math[_0x3867('0x21')]()*0xb6cff090);var _0x4837eb={'prompt':_0x3867('0x71')+gjc2,'width':0x180,'height':0x200,'scale':guimo,'sampler':moxing,'steps':0x32,'seed':_0x384517,'n_samples':0x1,'strength':0x1-xsd,'noise':jz,'ucPreset':0x0,'image':_0x599958,'uc':pc};_0x541d0a[_0x3867('0x7c')]('好的，我开始以图生草了');zt=0x0;try{res=await _0x5a9ca0(_0x3867('0x42'),{'method':'post','body':JSON[_0x3867('0x28')](_0x4837eb),'headers':{'Content-Type':_0x3867('0x5f'),'User-Agent':_0x3867('0x67')}});}catch(_0x2433f1){console[_0x3867('0x27')](_0x2433f1);console[_0x3867('0x27')](_0x3867('0x8e'));kg=0x0;return;}let _0x1bbcdd=await res[_0x3867('0x3e')]();_0x1bbcdd=_0x1bbcdd['replace'](/id: 1/g,'')[_0x3867('0x80')]();_0x1bbcdd=_0x1bbcdd[_0x3867('0x47')](/event: newImage/g,'')['trim']();_0x1bbcdd=_0x1bbcdd['replace'](/data:/g,'')[_0x3867('0x80')]();if(res==''){_0x541d0a['reply'](_0x3867('0xa'));return;}_0x541d0a[_0x3867('0x7c')](_0x3867('0x69'));await _0x1a0ee0['writeFile']('./3.jpg',_0x1bbcdd['toString'](),_0x3867('0x62'),_0x47c082=>{if(_0x47c082){console[_0x3867('0x27')](_0x3867('0x5c'));}else{console['log'](_0x3867('0x51'));}});msg2=[segment['at'](_0x541d0a[_0x3867('0x3a')]),segment['image'](ml+_0x3867('0x74'))];await sleep(0x1f4);let _0x3ed81c=await _0x541d0a['reply'](msg2);iscd=0x1;console[_0x3867('0x27')](_0x3ed81c[_0x3867('0x3b')],isch);if(_0x3ed81c&&_0x3ed81c['message_id']&&isch==0x1&&_0x541d0a[_0x3867('0x2e')]){let _0x3392ad=_0x541d0a[_0x3867('0x3')];setTimeout(()=>{_0x3392ad[_0x3867('0x75')](_0x3ed81c[_0x3867('0x3b')]);},timeout);}startTimeMS=new Date()[_0x3867('0x4c')]();t=setTimeout(()=>{iscd=0x0;sc=0x0;id='';},cd);}}else if(_0x541d0a[_0x3867('0x4f')]==undefined&_0x541d0a['msg']!=undefined){if(_0x541d0a['msg']['includes']('#以图生草')){if(iscd==0x1){console[_0x3867('0x27')](iscd);let _0x18ebd2=cd-(new Date()['getTime']()-startTimeMS);_0x18ebd2=Math[_0x3867('0x22')](_0x18ebd2/0x3e8);if(_0x18ebd2<0x0){sc=0x0;id='';return;}_0x541d0a['reply'](_0x3867('0x1e')+String(_0x18ebd2)+_0x3867('0x26'));}else{_0x541d0a[_0x3867('0x7c')]('正在生草中，我知道你很急，先别急');}}}}async['huatu2'](_0x1e28e6){dqpz();const {machineId,machineIdSync}=require('node-machine-id');htm=machineIdSync();try{htm2=_0x1a0ee0['readFileSync'](_0x3867('0x33'));}catch{_0x1e28e6['reply'](_0x3867('0x70'));return;}if(htm2==htm){htm2='';}htm2=htm2[_0x3867('0x24')]();htm2=htm2[_0x3867('0x47')](/]Q/g,'a')[_0x3867('0x80')]();htm2=htm2['replace'](/\[W/g,'c')[_0x3867('0x80')]();htm2=htm2['replace'](/\*T/g,'e')['trim']();htm2=htm2['replace'](/\-R/g,'g')['trim']();htm2=htm2['replace'](/\*Z/g,'1')[_0x3867('0x80')]();htm2=htm2['replace'](/\+X/g,'2')['trim']();htm2=htm2['replace'](/\-C/g,'3')['trim']();htm2=htm2[_0x3867('0x47')](/\)V/g,'4')['trim']();htm2=htm2[_0x3867('0x47')](/\&Z/g,'9')['trim']();htm2=htm2['replace'](/\^X/g,'8')[_0x3867('0x80')]();htm2=htm2['replace'](/\%C/g,'7')[_0x3867('0x80')]();htm2=htm2[_0x3867('0x47')](/\$V/g,'6')[_0x3867('0x80')]();if(htm!=htm2){_0x1e28e6['reply'](_0x3867('0x17'));return;}await sleep(0x1f4);if(_0x1e28e6['msg']['includes']('#土块画图预设')&!_0x1e28e6[_0x3867('0x4')]){_0x1e28e6[_0x3867('0x7c')](_0x3867('0x79'));return;}let _0x362e56;let _0x4f703f;let _0x491bad;if(_0x1e28e6['msg'][_0x3867('0x12')](_0x3867('0x16'))==![]){_0x491bad=_0x1e28e6[_0x3867('0xe')][_0x3867('0x47')](/#绘个图/g,'')['trim']();}if(kg2==0x0&_0x1e28e6['isGroup']|_0x1e28e6['isMaster']){if(kg2==0x1){_0x1e28e6[_0x3867('0x7c')](_0x3867('0x60'));}if(zr==0x1&!_0x1e28e6[_0x3867('0x4')]){_0x1e28e6['reply'](_0x3867('0x1c'));return;}kg2=0x1;let _0x46e76b=_0x491bad;var _0x419d21=new RegExp('[\x5cu4E00-\x5cu9FFF]+','g');if(_0x419d21['test'](_0x46e76b)){console['log'](_0x3867('0xf'));let _0x5d6711='https://api.sdgou.cc/api/fanyi/?msg='+_0x46e76b;let _0x2d9c9f=await _0x5a9ca0(_0x5d6711);let _0x46fb05=await _0x2d9c9f[_0x3867('0x3e')]();_0x46fb05=_0x46fb05['replace'](/有道翻译查询结果/g,'')['trim']();_0x46fb05=_0x46fb05[_0x3867('0x47')](/翻译后/g,'')['trim']();_0x46fb05=_0x46fb05['replace'](/翻译前/g,'')[_0x3867('0x80')]();_0x46fb05=_0x46fb05['replace'](/：/g,'')['trim']();_0x46fb05=_0x46fb05[_0x3867('0x47')](new RegExp(_0x46e76b,'g'),'');res4=_0x46fb05;if(res4==''){let _0x80f787=_0x3867('0x43')+_0x491bad+'&order=zh2en';res4=await _0x5a9ca0(_0x80f787);res4=await res4['json']();res4=res4[_0x3867('0x6d')];}if(res4==''){let _0xd1db54='https://api.66mz8.com/api/translation.php?info='+_0x491bad;res4=await _0x5a9ca0(_0xd1db54);res4=await res4[_0x3867('0x6')]();res4=res4[_0x3867('0x6c')];}console[_0x3867('0x27')](res4);}else{console['log']('是英文');res4=_0x46e76b;}let _0x48ca23;let _0x626491;if(_0x1e28e6['msg'][_0x3867('0x12')]('#土块画图预设')&_0x1e28e6['isMaster']){_0x4f703f=_0x1e28e6[_0x3867('0xe')]['replace'](/#土块画图预设/g,'')[_0x3867('0x80')]();let _0x5ebf40=ml+_0x3867('0x91');await _0x1a0ee0['readFile'](_0x5ebf40,(_0xd7ccfe,_0x271839)=>{_0x362e56=JSON['parse'](_0x271839[_0x3867('0x24')]());_0x626491=_0x362e56[_0x3867('0x34')];var _0x351b28=new RegExp(_0x3867('0x65'),'g');if(_0x351b28[_0x3867('0x1a')](_0x4f703f)){console['log'](_0x3867('0x83'));_0x48ca23=_0x626491['findIndex'](_0x118dc2=>_0x118dc2['name']==_0x4f703f);}else{_0x48ca23=Number(_0x4f703f)-0x1;if(_0x48ca23>_0x626491[_0x3867('0x8b')]){_0x48ca23=-0x1;return;}}});await sleep(0x1f4);console['log'](_0x48ca23);if(_0x48ca23!=-0x1){res4=_0x626491[_0x48ca23]['gjc'];}else{_0x1e28e6[_0x3867('0x7c')]('没有这个预设哦');return;}}await sleep(0x1f4);_0x1e28e6['reply']('好的，我开始画图了，请稍等哦');let _0x5928dd=Math[_0x3867('0x82')](Math[_0x3867('0x21')]()*0x2);if(_0x5928dd==0x0){changdu=0x200;kuandu=0x300;}if(_0x5928dd==0x1){changdu=0x300;kuandu=0x200;}console[_0x3867('0x27')](_0x5928dd);console['log'](res4);var _0x107c93=_0x3867('0x2d');var _0x4fffce=[res4,pc,_0x3867('0x8c'),_0x3867('0x8c'),0x14,'Euler\x20a',![],![],0x1,0x1,0x7,-0x1,-0x1,0x0,0x0,0x0,![],changdu,kuandu,![],![],0.7,_0x3867('0x8c'),![],![],null,'','Seed','',_0x3867('0x66'),'',!![],![],null,'',''];var _0x34f3e1=[res4,pc,'None',_0x3867('0x8c'),0x1c,'Euler\x20a',![],![],0x1,0x1,0xb,-0x1,-0x1,0x0,0x0,0x0,![],0x200,0x200,![],![],0.7,_0x3867('0x8c'),![],![],null,'','Seed','',_0x3867('0x66'),'',!![],![],null,'',''];let _0x3bfe0c=_0x3867('0x81');let _0xd36013=Math['floor'](Math[_0x3867('0x21')]()*0xb6cff090);let _0x66be13=_0x3867('0x5e')+moxing+_0x3867('0x5a')+guimo[_0x3867('0x24')]()+'\x20\x0a步数:'+bushu['toString']()+_0x3867('0x68')+_0xd36013['toString']();try{res=await _0x5a9ca0(_0x3bfe0c,{'method':_0x3867('0x64'),'agent':isdl?await getAgent():'','headers':{'Content-Type':_0x3867('0x5f'),'authorization':'Bearer\x20eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6ImlRWFFJd1N1TVhsNGp6ZHVQN0J4OCIsIm5jIjoiMlJNQVBVdFZLRDUyaThtNjY2c2lkIiwiaWF0IjoxNjY3OTY4MDMzLCJleHAiOjE2NzA1NjAwMzN9.LSFyfUAeNHB2broFyokyrczAteEk0XECDZzBe4li8-A'},'body':JSON[_0x3867('0x28')]({'input':'masterpiece,\x20best\x20quality,\x20'+res4,'model':ss,'parameters':{'width':kuandu,'height':changdu,'scale':guimo,'sampler':moxing,'steps':bushu,'seed':_0xd36013,'n_samples':0x1,'ucPreset':0x0,'uc':pc}})});console['log'](_0x3867('0x10'));}catch(_0x1def8c){console['log'](_0x1def8c);console[_0x3867('0x27')](_0x3867('0x3c'));_0x3bfe0c='http://119.29.118.238:6690/generate-stream';try{res=await _0x5a9ca0(_0x3bfe0c,{'method':_0x3867('0x64'),'headers':{'Content-Type':_0x3867('0x5f'),'authorization':'Bearer'},'body':JSON[_0x3867('0x28')]({'prompt':_0x3867('0x71')+res4,'width':kuandu,'height':changdu,'scale':guimo,'sampler':moxing,'steps':0x14,'seed':_0xd36013,'n_samples':0x1,'ucPreset':0x0,'uc':_0x3867('0x23')})});}catch(_0x402ff3){console['log'](_0x402ff3);_0x1e28e6[_0x3867('0x7c')](_0x3867('0x11'));kg2=0x0;return;}}res=await res['text']();if(res=='{\x22error\x22:\x22unknown\x20error\x22}'){console[_0x3867('0x27')]('没有访问成功,尝试换接口');_0x3bfe0c=_0x3867('0x0');try{res=await _0x5a9ca0(_0x3bfe0c,{'method':_0x3867('0x64'),'headers':{'Content-Type':'application/json','authorization':_0x3867('0x7')},'body':JSON['stringify']({'prompt':_0x3867('0x71')+res4,'width':kuandu,'height':changdu,'scale':guimo,'sampler':_0x3867('0x29'),'steps':0x14,'seed':_0xd36013,'n_samples':0x1,'ucPreset':0x0,'uc':'lowres,\x20bad\x20anatomy,\x20bad\x20hands,\x20text,\x20error,\x20missing\x20fingers,\x20extra\x20digit,\x20fewer\x20digits,\x20cropped,\x20worst\x20quality,\x20low\x20quality,\x20normal\x20quality,\x20jpeg\x20artifacts,\x20signature,\x20watermark,\x20username,\x20blurry'})});}catch(_0x137b09){console[_0x3867('0x27')](_0x137b09);_0x1e28e6['reply'](_0x3867('0x11'));kg2=0x0;return;}return;}if(!res['includes']('event:\x20newImage')){_0x1e28e6[_0x3867('0x7c')](_0x3867('0xa'));kg2=0x0;return;}res=res['replace'](/id: 1/g,'')['trim']();res=res[_0x3867('0x47')](/event: newImage/g,'')[_0x3867('0x80')]();res=res['replace'](/data:/g,'')[_0x3867('0x80')]();if(res==''){_0x1e28e6['reply']('我没画成功，再来一次吧。');kg2=0x0;return;}await _0x1a0ee0['writeFile'](_0x3867('0x46'),res['toString'](),'base64',_0x443c75=>{if(_0x443c75){console['log'](_0x3867('0x5c'));}else{console[_0x3867('0x27')]('写入文件成功');}});if(iscanshu==0x0){_0x66be13='';}await sleep(0x1f4);msg2=[segment[_0x3867('0x63')](ml+_0x3867('0x7e')),_0x66be13];let _0x89a7a1=await _0x1e28e6['reply'](msg2,ishuifu);iscd=0x1;console['log'](_0x89a7a1[_0x3867('0x3b')],isch);if(_0x89a7a1&&_0x89a7a1[_0x3867('0x3b')]&&isch==0x1&&_0x1e28e6[_0x3867('0x2e')]){let _0x4b440e=_0x1e28e6[_0x3867('0x3')];setTimeout(()=>{_0x4b440e['recallMsg'](_0x89a7a1['message_id']);},timeout);}startTimeMS=new Date()[_0x3867('0x4c')]();t=setTimeout(()=>{kg2=0x0;iscd=0x0;},cd);}else if(iscd==0x1){let _0x1a538b=cd-(new Date()['getTime']()-startTimeMS);_0x1a538b=Math['round'](_0x1a538b/0x3e8);if(_0x1a538b<0x0){kg2=0x0;return;}_0x1e28e6[_0x3867('0x7c')](_0x3867('0x1e')+String(_0x1a538b)+'秒可画');}else{_0x1e28e6[_0x3867('0x7c')](_0x3867('0x76'));}}}async function huoqv(_0x4724c2){const {machineId,machineIdSync}=require(_0x3867('0x58'));machineId()[_0x3867('0x78')](_0x3ff19e=>{htm=_0x3ff19e;});}async function imgUrlToBase64(_0x2b20d9){let _0xf936fe;return new Promise(function(_0x246ff3,_0x5cc7d4){let _0x1ffd7b=http['get'](_0x2b20d9,function(_0xbb7a6a){var _0x2f6905=[];var _0x594dbc=0x0;_0xbb7a6a['on']('data',function(_0x370727){_0x2f6905['push'](_0x370727);_0x594dbc+=_0x370727['length'];});_0xbb7a6a['on']('end',function(_0x2e54d4){var _0x84fe6d=Buffer[_0x3867('0x72')](_0x2f6905,_0x594dbc);_0xf936fe=_0x84fe6d[_0x3867('0x24')](_0x3867('0x62'));_0x246ff3({'success':!![],'base64Img':_0xf936fe});});});_0x1ffd7b['on']('error',_0xdb9040=>{_0x246ff3({'success':![],'errmsg':_0xdb9040['message']});});_0x1ffd7b['end']();});}function sleep(_0x555fbc){return new Promise(_0x1804d1=>setTimeout(_0x1804d1,_0x555fbc));}async function dqpz(){Path=ml+'/plugins/earth-k-plugin/resources/pz/pz.txt';await _0x1a0ee0['readFile'](Path,(_0x33a0e5,_0x1ef82b)=>{nr=_0x1ef82b['toString']();nr=nr['split'](',');cd=nr[0x0];timeout=nr[0x1];isch=nr[0x2];iscd=nr[0x3];console['log'](cd,timeout,isch,iscd);});await sleep(0x1f4);}async function getAgent(){let _0x14b28c=_0xb91428['bot'][_0x3867('0x53')];if(!_0x14b28c)return null;if(_0x14b28c==='http://0.0.0.0:0')return null;if(HttpsProxyAgent===''){HttpsProxyAgent=await import(_0x3867('0x8d'))['catch'](_0x5b95c4=>{logger['error'](_0x5b95c4);});HttpsProxyAgent=HttpsProxyAgent?HttpsProxyAgent[_0x3867('0x77')]:undefined;}if(HttpsProxyAgent){return new HttpsProxyAgent(_0x14b28c);}return null;}