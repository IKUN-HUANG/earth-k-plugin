const _0x34f1=['\x0a相似度：','步数不在合理范围内，28以下为合理范围','shuju','模型已设置为ddim','已设置冷却时间为','已关闭参数显示','trim','#查看预设词条','2MDQzLCJleHAiOjE2Njg4NTgwNDN9.YbBz70aDXeIwuipBzWjW-YHLToMhbAun5mQ-rGKmTR8','#土块画图预设','length','push','#删除屏蔽词','bot','error','新增屏蔽词成功','模型已设置为k_lms','预设包含中文','#查看屏蔽词','写入文件错误','#以图生草相似度','#土块画图撤回关闭','base64','没有这个预设哦','正在画图中，我知道你很急，但是你先别急。','#土块画图涩涩开启','writeFileSync','toString','concat','#新增屏蔽词','img','data','floor','#删除预设','Steps','None','message_id','没有访问成功,尝试换接口','round','^#土块画图规模(.*)','readFile','k_euler_ancestral','test','土块AI绘个图','我没画成功，再来一次吧。','已关闭代理','#查看画图设置','已开启画图冷却，冷却时间为30秒','成功了！','/3.jpg','已经取消','文件写入成功！','#开启参数显示','split','isGroup','已设置撤回时间为','qvht','json','开启代理成功','/plugins/earth-k-plugin/resources/htys/ys.json','包含中文','sj2','#以图生草','已开启词条回复','[\x5cu4E00-\x5cu9FFF]+','gjc','url','post','30秒还未发图，以图生草已取消','szbs','已关闭画图冷却','模型已设置为k_euler','./2.png','你不是主人，不能用预设哦','parse','lowres,nude,\x20bad\x20anatomy,\x20bad\x20hands,\x20text,\x20error,\x20missing\x20fingers,\x20extra\x20digit,\x20fewer\x20digits,\x20cropped,\x20worst\x20quality,\x20low\x20quality,\x20normal\x20quality,\x20jpeg\x20artifacts,\x20signature,\x20watermark,\x20username,\x20blurry,\x20owres,\x20bad\x20anatomy,\x20bad\x20hands,\x20text,\x20error,\x20missing\x20fingers,\x20extra\x20digit,\x20fewer\x20digits,\x20cropped,\x20worst\x20quality,\x20low\x20quality,\x20normal\x20quality,\x20jpeg\x20artifacts,\x20signature,\x20watermark,\x20username,\x20blurry','新增预设成功','规模已设置为','对不起，你不可画哦','#关闭词条回复','isMaster','stringify','#查看所有模型','好的，权限已经关闭，只有你能画了','log','秒可画','random','/plugins/earth-k-plugin/resources/pz/pz.txt','我知道你要干嘛！注意身体！','正在生草中，我知道你很急，先别急','kqdl','以图生草','masterpiece,\x20best\x20quality,\x20','#所有人可画','Euler\x20a','text','replace','masterpiece,\x20best\x20quality,','\x20\x20\x20|规模:','msg','删除预设成功','end','utf-8','是英文','我在cd中，还有','k_euler','\x20\x20\x20\x20\x20\x20\x20\x20|seed:','catch','szmx','好的，我开始画图了，请稍等哦','base64Img','\x20http://www.iinside.cn:7001/api_req?reqmode=nmt_mt5_jez&password=3652&text=','已经开启默认屏蔽词','删除屏蔽词成功','includes','没有访问成功哦','pbc','cwd','reply','^#土块画图模型(.*)|^#查看所有模型','image','没有访问成功','name','好的，我开始以图生草了','message','好吧，那就一起来吧！','请发送图片','以图生草暂不支持私聊','szgm','https-proxy-agent','writeFile','huatu2'];const _0x55b1=function(_0x34f1cd,_0x55b17e){_0x34f1cd=_0x34f1cd-0x0;let _0x24f64a=_0x34f1[_0x34f1cd];return _0x24f64a;};import{segment}from'oicq';import _0xa497c9 from'node-fetch';import _0x151b63,{chownSync}from'fs';import _0x332620 from'../../../lib/config/config.js';import _0x48271b from'../../../lib/puppeteer/puppeteer.js';let data1={};import{createRequire}from'module';import{Console}from'console';const require=createRequire(import.meta[_0x55b1('0x42')]);let ysct;let ml=process[_0x55b1('0x75')]();var http=require('http');import _0x329983 from'lodash';let yushekg=0x0;let kg=0x0;let guimo=5.5;let kg2=0x0;let res4;let res5;let res;let zr=0x0;let changdu=0x200;let kuandu=0x200;let msg2;let timeout=0x7530;let isch=0x1;let cd=0x0;let t;let startTimeMS;let iscd=0x0;let my;let dz;let sj1;let sj2;let shuju;let zt=0x0;let gjc2;let sc=0x0;let bushu=0x1c;let id='';let xsd=0.4;let nr;let ycqx;let jz=0.2;let ss='nai-diffusion';let Path;let ys=[];let moxing=_0x55b1('0x69');let isdl=0x0;let iscanshu=0x1;let ishuifu=!![];let HttpsProxyAgent='';let pc=_0x55b1('0x4b');export class aiht extends plugin{constructor(){super({'name':_0x55b1('0x2b'),'dsc':_0x55b1('0x2b'),'event':_0x55b1('0x7c'),'priority':0x479,'rule':[{'reg':'^#绘个图(.*)$|#土块画图预设(.*)$','fnc':_0x55b1('0x83')},{'reg':'^#取消画图$|^#所有人可画$|^#仅我可画$|^#土块画图撤回(.*)$|^#土块画图冷却(.*)$|^#土块画图涩涩开启|^#土块画图涩涩关闭','fnc':_0x55b1('0x38')},{'reg':'^#新增屏蔽词(.*)$|#查看屏蔽词$|#删除屏蔽词$|#开启默认屏蔽词$','fnc':'pbc'},{'reg':'^#以图生草(.*)$|(.*)','fnc':'huatu3','log':![]},{'reg':'^#查看所有预设$|#新增预设(.*)|(.*)','fnc':'ysgn','log':![]},{'reg':_0x55b1('0x27'),'fnc':'szgm'},{'reg':_0x55b1('0x77'),'fnc':'szmx'},{'reg':'^#土块画图步数(.*)|^#查看画图设置','fnc':_0x55b1('0x45')},{'reg':'^#开启代理|^#关闭代理|^#开启参数显示|^#关闭参数显示|^#开启词条回复|^#关闭词条回复','fnc':_0x55b1('0x5a')}]});}async[_0x55b1('0x5a')](_0x33ca69){if(_0x33ca69[_0x55b1('0x63')]=='#开启代理'&_0x33ca69[_0x55b1('0x50')]){isdl=0x1;_0x33ca69[_0x55b1('0x76')](_0x55b1('0x3a'));}if(_0x33ca69['msg']=='#关闭代理'&_0x33ca69['isMaster']){isdl=0x0;_0x33ca69[_0x55b1('0x76')](_0x55b1('0x2d'));}if(_0x33ca69[_0x55b1('0x63')]==_0x55b1('0x34')&_0x33ca69['isMaster']){iscanshu=0x1;_0x33ca69[_0x55b1('0x76')]('已开启参数显示');}if(_0x33ca69['msg']=='#关闭参数显示'&_0x33ca69['isMaster']){iscanshu=0x0;_0x33ca69[_0x55b1('0x76')](_0x55b1('0x5'));}if(_0x33ca69[_0x55b1('0x63')]=='#开启词条回复'&_0x33ca69[_0x55b1('0x50')]){ishuifu=!![];_0x33ca69[_0x55b1('0x76')](_0x55b1('0x3f'));}if(_0x33ca69[_0x55b1('0x63')]==_0x55b1('0x4f')&_0x33ca69['isMaster']){ishuifu=![];_0x33ca69['reply']('已关闭词条回复');}}async['szbs'](_0x544538){if(_0x544538[_0x55b1('0x63')]==_0x55b1('0x2e')){console[_0x55b1('0x54')](guimo);let _0x42c650=['模型：',moxing,'\x0a规模：',guimo[_0x55b1('0x1b')](),'\x0a步数：',bushu['toString'](),_0x55b1('0x0'),xsd[_0x55b1('0x1b')](),'\x0a降噪：',jz[_0x55b1('0x1b')]()];_0x544538[_0x55b1('0x76')](_0x42c650);return;}bushu=_0x544538['msg'][_0x55b1('0x60')](/#土块画图步数/g,'')[_0x55b1('0x6')]();bushu=Number(bushu);if(bushu<0x0|bushu>0x1c){bushu=0x1c;_0x544538['reply'](_0x55b1('0x1'));return;}else{_0x544538['reply']('步数已设置为'+String(bushu));}}async[_0x55b1('0x6c')](_0x5e1dad){if(_0x5e1dad['msg']==_0x55b1('0x52')){let _0x3beb0d=['1：k_euler_ancestral,\x0a2：k_euler,\x0a3：k_lms,\x0a4：plms,\x0a5：ddim'];_0x5e1dad['reply'](_0x3beb0d);return;}moxing=_0x5e1dad[_0x55b1('0x63')][_0x55b1('0x60')](/#土块画图模型/g,'')['trim']();moxing=Number(moxing);if(moxing<0x0|moxing>0x5){_0x5e1dad['reply']('模型不在合理范围内，1-5为合理范围');moxing=0x2;return;}if(moxing==0x1){moxing=_0x55b1('0x29');_0x5e1dad['reply']('模型已设置为k_euler_ancestral');}if(moxing==0x2){moxing=_0x55b1('0x69');_0x5e1dad[_0x55b1('0x76')](_0x55b1('0x47'));}if(moxing==0x3){moxing='k_lms';_0x5e1dad[_0x55b1('0x76')](_0x55b1('0x10'));}if(moxing==0x4){moxing='plms';_0x5e1dad[_0x55b1('0x76')]('模型已设置为plms');}if(moxing==0x5){moxing='ddim';_0x5e1dad['reply'](_0x55b1('0x3'));}}async[_0x55b1('0x80')](_0x5d5917){guimo=_0x5d5917[_0x55b1('0x63')]['replace'](/#土块画图规模/g,'')['trim']();guimo=Number(guimo);if(guimo<0x3|guimo>0xc){_0x5d5917['reply']('规模不在合理范围内，3-12为合理范围');guimo=5.5;return;}else{_0x5d5917['reply'](_0x55b1('0x4d')+String(guimo));}}async['ysgn'](_0x5c08a6){if(yushekg==0x0&_0x5c08a6[_0x55b1('0x63')][_0x55b1('0x72')]('#查看预设')==![]&_0x5c08a6[_0x55b1('0x63')]['includes']('#新增预设')==![]&_0x5c08a6['msg']['includes'](_0x55b1('0x21'))==![]&_0x5c08a6['msg']['includes']('#查看预设词条')==![]){return![];}let _0x40bf49=ml+_0x55b1('0x3b');let _0x868a08='';await _0x151b63['readFile'](_0x40bf49,(_0x577478,_0x12cfbd)=>{if(_0x577478)throw _0x577478;var _0xae5528=_0x12cfbd[_0x55b1('0x1b')]()!=''?JSON[_0x55b1('0x4a')](_0x12cfbd['toString']()):[];ysct='';_0x868a08='';shuju=_0xae5528;for(let _0x3d6327=0x0;_0x3d6327<shuju['shuju']['length'];_0x3d6327++){_0x868a08=_0x868a08+shuju['shuju'][_0x3d6327]['name']+',';ysct=ysct+shuju['shuju'][_0x3d6327][_0x55b1('0x41')]+'++';}});await sleep(0x1f4);if(_0x5c08a6['msg'][_0x55b1('0x72')](_0x55b1('0x7'))&_0x5c08a6['isMaster']){let _0x291623=_0x5c08a6[_0x55b1('0x63')][_0x55b1('0x60')](/#查看预设词条/g,'')['trim']();_0x291623=Number(_0x291623);ysct=ysct[_0x55b1('0x35')]('++');_0x868a08=_0x868a08['split'](',');if(_0x291623>ysct['length']|_0x291623<0x0){_0x5c08a6['reply']('数字超过了预设个数');return;}_0x5c08a6['reply']([_0x868a08[_0x291623-0x1],':',ysct[_0x291623-0x1]]);ysct='';_0x868a08='';}if(_0x5c08a6['msg']=='#查看预设'&_0x5c08a6[_0x55b1('0x50')]){_0x868a08=_0x868a08[_0x55b1('0x35')](',');data1={'tplFile':'./plugins/earth-k-plugin/resources/aiht/ml.html','dz':ml,'lb':_0x868a08,'qsid':0x0};let _0x4cf6ef=await _0x48271b['screenshot']('123',{...data1});_0x5c08a6['reply'](_0x4cf6ef);return;_0x5c08a6['reply']('当前预设有：\x0a'+_0x868a08);}if(_0x5c08a6['msg'][_0x55b1('0x72')](_0x55b1('0x21'))&_0x5c08a6['isMaster']){let _0x575345=_0x5c08a6[_0x55b1('0x63')][_0x55b1('0x60')](/#删除预设/g,'')['trim']();_0x575345=Number(_0x575345);if(_0x575345<shuju['shuju'][_0x55b1('0xa')]+0x1){shuju[_0x55b1('0x2')]['splice'](_0x575345-0x1,0x1);var _0x4b1382=JSON[_0x55b1('0x51')](shuju);}_0x151b63[_0x55b1('0x82')](_0x40bf49,_0x4b1382,function(_0x5eab70){if(_0x5eab70){console[_0x55b1('0xe')](_0x5eab70);}_0x5c08a6[_0x55b1('0x76')](_0x55b1('0x64'));});}if(_0x5c08a6['msg'][_0x55b1('0x72')]('#新增预设')&_0x5c08a6[_0x55b1('0x50')]&yushekg==0x0){yushekg=0x1;ys[0x0]=_0x5c08a6['msg']['replace'](/#新增预设/g,'')[_0x55b1('0x6')]();_0x5c08a6['reply']('请添加预设关键词');return;}if(yushekg==0x1&_0x5c08a6[_0x55b1('0x50')]){yushekg=0x0;ys[0x1]=_0x5c08a6['msg'];let _0x2a2945={'name':ys[0x0],'gjc':ys[0x1]};shuju[_0x55b1('0x2')][_0x55b1('0xb')](_0x2a2945);console['log'](shuju);var _0x4b1382=JSON[_0x55b1('0x51')](shuju);_0x151b63[_0x55b1('0x82')](_0x40bf49,_0x4b1382,_0x4ce66f=>{if(_0x4ce66f)throw _0x4ce66f;console['log'](_0x55b1('0x33'));_0x5c08a6['reply'](_0x55b1('0x4c'));});return;}}async[_0x55b1('0x74')](_0x3a3a4b){if(_0x3a3a4b[_0x55b1('0x63')]['includes'](_0x55b1('0x1d'))&_0x3a3a4b['isMaster']){_0x3a3a4b['reply'](_0x55b1('0xf'));pc=_0x3a3a4b['msg'][_0x55b1('0x60')](/#新增屏蔽词/g,'')['trim']();}if(_0x3a3a4b['msg']==_0x55b1('0x12')&_0x3a3a4b[_0x55b1('0x50')]){_0x3a3a4b[_0x55b1('0x76')](['当前屏蔽词有：',pc]);}if(_0x3a3a4b['msg']['includes'](_0x55b1('0xc'))&_0x3a3a4b[_0x55b1('0x50')]){_0x3a3a4b['reply'](_0x55b1('0x71')+_0x55b1('0x58'));pc='';}if(_0x3a3a4b[_0x55b1('0x63')][_0x55b1('0x72')]('#开启默认屏蔽词')&_0x3a3a4b['isMaster']){_0x3a3a4b['reply'](_0x55b1('0x70'));pc='lowres,nude,\x20bad\x20anatomy,\x20bad\x20hands,\x20text,\x20error,\x20missing\x20fingers,\x20extra\x20digit,\x20fewer\x20digits,\x20cropped,\x20worst\x20quality,\x20low\x20quality,\x20normal\x20quality,\x20jpeg\x20artifacts,\x20signature,\x20watermark,\x20username,\x20blurry,\x20owres,\x20bad\x20anatomy,\x20bad\x20hands,\x20text,\x20error,\x20missing\x20fingers,\x20extra\x20digit,\x20fewer\x20digits,\x20cropped,\x20worst\x20quality,\x20low\x20quality,\x20normal\x20quality,\x20jpeg\x20artifacts,\x20signature,\x20watermark,\x20username,\x20blurry';}}async[_0x55b1('0x38')](_0x3900fe){if(_0x3900fe['msg']==_0x55b1('0x19')&_0x3900fe['isMaster']){_0x3900fe[_0x55b1('0x76')]('好的，已开启，请注意身体哦');ss='nai-diffusion';}if(_0x3900fe['msg']=='#土块画图涩涩关闭'&_0x3900fe['isMaster']){_0x3900fe['reply']('好的，已关闭了');ss='safe-diffusion';}await dqpz();if(_0x3900fe[_0x55b1('0x63')][_0x55b1('0x72')]('#土块画图冷却关闭')&_0x3900fe[_0x55b1('0x50')]){nr[0x3]=0x0;nr[0x0]=0x0;_0x151b63[_0x55b1('0x1a')](Path,nr[_0x55b1('0x1b')](),'utf-8');cd=0x0;kg2=0x0;kg=0x0;sc=0x0;iscd=0x0;_0x3900fe['reply'](_0x55b1('0x46'));return;}if(_0x3900fe[_0x55b1('0x63')][_0x55b1('0x72')]('#土块画图冷却开启')&_0x3900fe[_0x55b1('0x50')]){nr[0x0]=0x7530;nr[0x3]=0x1;_0x151b63[_0x55b1('0x1a')](Path,nr[_0x55b1('0x1b')](),'utf-8');cd=0x7530;_0x3900fe['reply'](_0x55b1('0x2f'));return;}if(_0x3900fe[_0x55b1('0x63')]['includes']('#土块画图冷却')&_0x3900fe[_0x55b1('0x50')]){let _0xf77899=_0x3900fe['msg'][_0x55b1('0x60')](/#土块画图冷却/g,'')[_0x55b1('0x6')]();cd=Number(_0xf77899)*0x3e8;nr[0x0]=cd;nr[0x3]=0x1;_0x151b63['writeFileSync'](Path,nr['toString'](),'utf-8');_0x3900fe[_0x55b1('0x76')](_0x55b1('0x4')+_0xf77899+'秒');}if(_0x3900fe['msg'][_0x55b1('0x72')](_0x55b1('0x15'))&_0x3900fe[_0x55b1('0x50')]){nr[0x2]=0x0;_0x151b63['writeFileSync'](Path,nr[_0x55b1('0x1b')](),_0x55b1('0x66'));isch=0x0;_0x3900fe[_0x55b1('0x76')]('已关闭画图撤回');return;}if(_0x3900fe['msg'][_0x55b1('0x72')]('#土块画图撤回开启')&_0x3900fe['isMaster']){isch=0x1;nr[0x1]=0x7530;nr[0x2]=0x1;_0x151b63['writeFileSync'](Path,nr['toString'](),_0x55b1('0x66'));timeout=0x7530;_0x3900fe['reply']('已开启画图撤回，撤回时间为30秒');return;}if(_0x3900fe['msg']['includes']('#土块画图撤回')&_0x3900fe[_0x55b1('0x50')]){isch=0x1;let _0x5a853a=_0x3900fe['msg'][_0x55b1('0x60')](/#土块画图撤回/g,'')[_0x55b1('0x6')]();timeout=Number(_0x5a853a)*0x3e8;nr[0x1]=timeout;nr[0x2]=0x1;_0x151b63[_0x55b1('0x1a')](Path,nr['toString'](),'utf-8');_0x3900fe['reply'](_0x55b1('0x37')+_0x5a853a+'秒');}if(_0x3900fe['msg']=='#取消画图'){kg=0x0;sc=0x0;zt=0x0;id='';console['log'](_0x55b1('0x32'));kg2=0x0;_0x3900fe[_0x55b1('0x76')]('已取消当前画图');}if(_0x3900fe[_0x55b1('0x63')]==_0x55b1('0x5d')&_0x3900fe[_0x55b1('0x50')]){_0x3900fe[_0x55b1('0x76')](_0x55b1('0x7d'));zr=0x0;}if(_0x3900fe['msg']=='#仅我可画'&_0x3900fe['isMaster']){_0x3900fe['reply'](_0x55b1('0x53'));zr=0x1;}}async['huatu3'](_0x1d90d0){if(_0x1d90d0['img']&zt==0x0){return![];}if(_0x1d90d0['img']==undefined&_0x1d90d0[_0x55b1('0x63')]!=undefined){if(_0x1d90d0['msg'][_0x55b1('0x72')](_0x55b1('0x3e'))==![]&_0x1d90d0[_0x55b1('0x1e')]==undefined&zt==0x0){return![];}}if(_0x1d90d0[_0x55b1('0x1e')]==undefined&zt==0x1){return![];}if(_0x1d90d0['img']==undefined&_0x1d90d0[_0x55b1('0x63')]!=undefined){dqpz();if(_0x1d90d0['msg']['includes'](_0x55b1('0x14'))&_0x1d90d0['isMaster']){xsd=Number(_0x1d90d0['msg'][_0x55b1('0x60')](/#以图生草相似度/g,'')[_0x55b1('0x6')]())/0x64;_0x1d90d0['reply']('当前相似度'+String(xsd));console[_0x55b1('0x54')](xsd);return;}if(_0x1d90d0['msg']['includes']('#以图生草降噪')&_0x1d90d0['isMaster']){jz=Number(_0x1d90d0[_0x55b1('0x63')]['replace'](/#以图生草降噪/g,'')[_0x55b1('0x6')]())/0x64;_0x1d90d0[_0x55b1('0x76')]('当前降噪'+String(jz));console['log'](jz);return;}if(zt==0x0&&sc==0x0&&_0x1d90d0['msg']['includes'](_0x55b1('0x3e'))){if(_0x1d90d0['isPrivate']){_0x1d90d0[_0x55b1('0x76')](_0x55b1('0x7f'));return;}console[_0x55b1('0x54')](_0x55b1('0x5b'));id=_0x1d90d0['user_id'];gjc2=_0x1d90d0[_0x55b1('0x63')][_0x55b1('0x60')](/#以图生草/g,'')[_0x55b1('0x6')]();var _0x1cb030=new RegExp('[\x5cu4E00-\x5cu9FFF]+','g');if(_0x1cb030[_0x55b1('0x2a')](gjc2)){console['log']('包含中文');let _0x250b17='https://api.sdgou.cc/api/fanyi/?msg='+gjc2;let _0x88ced5=await _0xa497c9(_0x250b17);let _0x1fb4c9=await _0x88ced5[_0x55b1('0x5f')]();_0x1fb4c9=_0x1fb4c9[_0x55b1('0x60')](/有道翻译查询结果/g,'')[_0x55b1('0x6')]();_0x1fb4c9=_0x1fb4c9['replace'](/翻译后/g,'')['trim']();_0x1fb4c9=_0x1fb4c9[_0x55b1('0x60')](/翻译前/g,'')[_0x55b1('0x6')]();_0x1fb4c9=_0x1fb4c9['replace'](/：/g,'')[_0x55b1('0x6')]();_0x1fb4c9=_0x1fb4c9[_0x55b1('0x60')](new RegExp(gjc2,'g'),'');gjc2=_0x1fb4c9;console['log'](gjc2);}else{console['log'](_0x55b1('0x67'));}zt=0x1;ycqx=setTimeout(()=>{if(zt==0x1){zt=0x0;_0x1d90d0['reply'](_0x55b1('0x44'));return;}},0x7530);_0x1d90d0['reply']([segment['at'](id),_0x55b1('0x7e')]);return;}}if(sc==0x0&_0x1d90d0[_0x55b1('0x36')]&zt==0x1&_0x1d90d0[_0x55b1('0x1e')]!=undefined){clearTimeout(ycqx);let _0x119180=ml+'/plugins/earth-k-plugin/resources/my/my.json';let _0x4f1614;await _0x151b63[_0x55b1('0x28')](_0x119180,(_0x46073a,_0x1d4340)=>{my=JSON['parse'](_0x1d4340['toString']());dz=my['miyao2'];_0x4f1614=my['yh2'];});await sleep(0x1f4);if(_0x1d90d0['user_id']==id&zt==0x1){sc=0x1;let _0x125629=await imgUrlToBase64(_0x1d90d0[_0x55b1('0x1e')][0x0]['replace'](/https/g,'http')['trim']());let _0x4094fc=_0x125629[_0x55b1('0x6e')];let _0x4eba91=Math[_0x55b1('0x20')](Math['random']()*0xb6cff090);var _0x10e3c5={'prompt':_0x55b1('0x61')+gjc2,'width':0x180,'height':0x200,'scale':guimo,'sampler':moxing,'steps':0x32,'seed':_0x4eba91,'n_samples':0x1,'strength':0x1-xsd,'noise':jz,'ucPreset':0x0,'image':_0x4094fc,'uc':pc};_0x1d90d0[_0x55b1('0x76')](_0x55b1('0x7b'));zt=0x0;try{res=await _0xa497c9(dz,{'method':_0x55b1('0x43'),'body':JSON[_0x55b1('0x51')](_0x10e3c5),'headers':{'Content-Type':'application/json','User-Agent':'Mozilla/5.0\x20(Windows\x20NT\x206.1;\x20WOW64)\x20AppleWebKit/537.36\x20(KHTML,\x20like\x20Gecko)\x20Chrome/86.0.4240.198\x20Safari/537.36'}});}catch(_0x5c2e30){console['log'](_0x5c2e30);console['log'](_0x55b1('0x79'));kg=0x0;return;}let _0x408281=await res['text']();_0x408281=_0x408281['replace'](/id: 1/g,'')[_0x55b1('0x6')]();_0x408281=_0x408281[_0x55b1('0x60')](/event: newImage/g,'')[_0x55b1('0x6')]();_0x408281=_0x408281[_0x55b1('0x60')](/data:/g,'')['trim']();if(res==''){_0x1d90d0[_0x55b1('0x76')]('我没画成功，再来一次吧。');return;}_0x1d90d0['reply'](_0x55b1('0x30'));await _0x151b63[_0x55b1('0x82')]('./3.jpg',_0x408281[_0x55b1('0x1b')](),'base64',_0x2be44e=>{if(_0x2be44e){console[_0x55b1('0x54')](_0x55b1('0x13'));}else{console['log']('写入文件成功');}});msg2=[segment['at'](_0x1d90d0['user_id']),segment[_0x55b1('0x78')](ml+_0x55b1('0x31'))];await sleep(0x1f4);let _0x448bc5=await _0x1d90d0[_0x55b1('0x76')](msg2);iscd=0x1;console[_0x55b1('0x54')](_0x448bc5['message_id'],isch);if(_0x448bc5&&_0x448bc5['message_id']&&isch==0x1&&_0x1d90d0[_0x55b1('0x36')]){let _0x12c2b3=_0x1d90d0['group'];setTimeout(()=>{_0x12c2b3['recallMsg'](_0x448bc5['message_id']);},timeout);}startTimeMS=new Date()['getTime']();t=setTimeout(()=>{iscd=0x0;sc=0x0;id='';},cd);}}else if(_0x1d90d0[_0x55b1('0x1e')]==undefined&_0x1d90d0['msg']!=undefined){if(_0x1d90d0[_0x55b1('0x63')]['includes'](_0x55b1('0x3e'))){if(iscd==0x1){console['log'](iscd);let _0x2bff18=cd-(new Date()['getTime']()-startTimeMS);_0x2bff18=Math[_0x55b1('0x26')](_0x2bff18/0x3e8);if(_0x2bff18<0x0){sc=0x0;id='';return;}_0x1d90d0['reply']('我在cd中，还有'+String(_0x2bff18)+_0x55b1('0x55'));}else{_0x1d90d0[_0x55b1('0x76')](_0x55b1('0x59'));}}}}async['huatu2'](_0xaf3fe9){dqpz();let _0x67344b=ml+'/plugins/earth-k-plugin/resources/my/my.json';let _0x1baa2c;let _0x14ae9e;let _0x2030bd;await _0x151b63[_0x55b1('0x28')](_0x67344b,(_0x4fd183,_0x24f283)=>{my=JSON['parse'](_0x24f283['toString']());dz=my['miyao'];sj1=my['sj1'];sj2=my[_0x55b1('0x3d')];_0x1baa2c=my['zh'];_0x14ae9e=my['miyao2'];_0x2030bd=my['yh2'];});await sleep(0x1f4);if(dz==''){_0xaf3fe9['reply']('你还不可以用该功能哦');return;}if(_0xaf3fe9['msg'][_0x55b1('0x72')]('#土块画图预设')&!_0xaf3fe9['isMaster']){_0xaf3fe9['reply'](_0x55b1('0x49'));return;}let _0x11edbc;let _0x38a383;let _0x12b464;if(_0xaf3fe9[_0x55b1('0x63')]['includes'](_0x55b1('0x9'))==![]){_0x12b464=_0xaf3fe9[_0x55b1('0x63')][_0x55b1('0x60')](/#绘个图/g,'')['trim']();}if(kg2==0x0&_0xaf3fe9['isGroup']|_0xaf3fe9['isMaster']){if(kg2==0x1){_0xaf3fe9['reply']('你是主人，没有cd，欸嘿');}if(zr==0x1&!_0xaf3fe9[_0x55b1('0x50')]){_0xaf3fe9[_0x55b1('0x76')](_0x55b1('0x4e'));return;}kg2=0x1;let _0xbcccf4=_0x12b464;var _0x140541=new RegExp(_0x55b1('0x40'),'g');if(_0x140541[_0x55b1('0x2a')](_0xbcccf4)){console[_0x55b1('0x54')](_0x55b1('0x3c'));let _0xf6c055='https://api.sdgou.cc/api/fanyi/?msg='+_0xbcccf4;let _0x2640eb=await _0xa497c9(_0xf6c055);let _0x7c21ec=await _0x2640eb[_0x55b1('0x5f')]();_0x7c21ec=_0x7c21ec['replace'](/有道翻译查询结果/g,'')[_0x55b1('0x6')]();_0x7c21ec=_0x7c21ec[_0x55b1('0x60')](/翻译后/g,'')[_0x55b1('0x6')]();_0x7c21ec=_0x7c21ec[_0x55b1('0x60')](/翻译前/g,'')[_0x55b1('0x6')]();_0x7c21ec=_0x7c21ec['replace'](/：/g,'')[_0x55b1('0x6')]();_0x7c21ec=_0x7c21ec[_0x55b1('0x60')](new RegExp(_0xbcccf4,'g'),'');res4=_0x7c21ec;if(res4==''){let _0x2d8343=_0x55b1('0x6f')+_0x12b464+'&order=zh2en';res4=await _0xa497c9(_0x2d8343);res4=await res4[_0x55b1('0x39')]();res4=res4['data'];}if(res4==''){let _0x52595a='https://api.66mz8.com/api/translation.php?info='+_0x12b464;res4=await _0xa497c9(_0x52595a);res4=await res4['json']();res4=res4['fanyi'];}console['log'](res4);}else{console[_0x55b1('0x54')](_0x55b1('0x67'));res4=_0xbcccf4;}let _0x60393f;let _0x40a9b5;if(_0xaf3fe9[_0x55b1('0x63')][_0x55b1('0x72')](_0x55b1('0x9'))&_0xaf3fe9['isMaster']){_0x38a383=_0xaf3fe9['msg']['replace'](/#土块画图预设/g,'')['trim']();let _0x45bcf7=ml+_0x55b1('0x3b');await _0x151b63[_0x55b1('0x28')](_0x45bcf7,(_0x3fb73b,_0x5947f1)=>{_0x11edbc=JSON[_0x55b1('0x4a')](_0x5947f1[_0x55b1('0x1b')]());_0x40a9b5=_0x11edbc[_0x55b1('0x2')];var _0x5c5bb4=new RegExp(_0x55b1('0x40'),'g');if(_0x5c5bb4[_0x55b1('0x2a')](_0x38a383)){console[_0x55b1('0x54')](_0x55b1('0x11'));_0x60393f=_0x40a9b5['findIndex'](_0x7d5576=>_0x7d5576[_0x55b1('0x7a')]==_0x38a383);}else{_0x60393f=Number(_0x38a383)-0x1;if(_0x60393f>_0x40a9b5['length']){_0x60393f=-0x1;return;}}});await sleep(0x1f4);console[_0x55b1('0x54')](_0x60393f);if(_0x60393f!=-0x1){res4=_0x40a9b5[_0x60393f][_0x55b1('0x41')];}else{_0xaf3fe9['reply'](_0x55b1('0x17'));return;}}await sleep(0x1f4);_0xaf3fe9[_0x55b1('0x76')](_0x55b1('0x6d'));let _0x211ef9=Math[_0x55b1('0x20')](Math[_0x55b1('0x56')]()*0x2);if(_0x211ef9==0x0){changdu=0x200;kuandu=0x300;}if(_0x211ef9==0x1){changdu=0x300;kuandu=0x200;}console['log'](_0x211ef9);console['log'](res4);var _0x56bd00='abc';var _0x44e888=[res4,pc,_0x55b1('0x23'),_0x55b1('0x23'),0x14,_0x55b1('0x5e'),![],![],0x1,0x1,0x7,-0x1,-0x1,0x0,0x0,0x0,![],changdu,kuandu,![],![],0.7,'None',![],![],null,'','Seed','',_0x55b1('0x22'),'',!![],![],null,'',''];var _0x38ef9b=[res4,pc,_0x55b1('0x23'),_0x55b1('0x23'),0x1c,'Euler\x20a',![],![],0x1,0x1,0xb,-0x1,-0x1,0x0,0x0,0x0,![],0x200,0x200,![],![],0.7,'None',![],![],null,'','Seed','',_0x55b1('0x22'),'',!![],![],null,'',''];let _0x1e3ffa=dz;let _0xebcf24=Math[_0x55b1('0x20')](Math[_0x55b1('0x56')]()*0xb6cff090);let _0x389efc='模型:'+moxing+_0x55b1('0x62')+guimo[_0x55b1('0x1b')]()+'\x20\x0a步数:'+bushu['toString']()+_0x55b1('0x6a')+_0xebcf24['toString']();try{res=await _0xa497c9(_0x1e3ffa,{'method':'post','agent':isdl?await getAgent():'','headers':{'Content-Type':'application/json','authorization':_0x1baa2c+_0x55b1('0x8')},'body':JSON[_0x55b1('0x51')]({'input':_0x55b1('0x5c')+res4,'model':ss,'parameters':{'width':kuandu,'height':changdu,'scale':guimo,'sampler':moxing,'steps':bushu,'seed':_0xebcf24,'n_samples':0x1,'ucPreset':0x0,'uc':pc}})});console[_0x55b1('0x54')]('访问成功了');}catch(_0xdebd7){console[_0x55b1('0x54')](_0xdebd7);console['log'](_0x55b1('0x25'));_0x1e3ffa=_0x14ae9e;try{res=await _0xa497c9(_0x1e3ffa,{'method':_0x55b1('0x43'),'headers':{'Content-Type':'application/json','authorization':_0x2030bd},'body':JSON[_0x55b1('0x51')]({'prompt':_0x55b1('0x61')+res4,'width':kuandu,'height':changdu,'scale':guimo,'sampler':moxing,'steps':0x14,'seed':_0xebcf24,'n_samples':0x1,'ucPreset':0x0,'uc':'lowres,\x20bad\x20anatomy,\x20bad\x20hands,\x20text,\x20error,\x20missing\x20fingers,\x20extra\x20digit,\x20fewer\x20digits,\x20cropped,\x20worst\x20quality,\x20low\x20quality,\x20normal\x20quality,\x20jpeg\x20artifacts,\x20signature,\x20watermark,\x20username,\x20blurry'})});}catch(_0x28ebad){console['log'](_0x28ebad);_0xaf3fe9[_0x55b1('0x76')](_0x55b1('0x73'));kg2=0x0;return;}}res=await res['text']();if(res=='{\x22error\x22:\x22unknown\x20error\x22}'){console['log'](_0x55b1('0x25'));_0x1e3ffa=_0x14ae9e;try{res=await _0xa497c9(_0x1e3ffa,{'method':_0x55b1('0x43'),'headers':{'Content-Type':'application/json','authorization':_0x2030bd},'body':JSON['stringify']({'prompt':'masterpiece,\x20best\x20quality,'+res4,'width':kuandu,'height':changdu,'scale':guimo,'sampler':'k_euler_ancestral','steps':0x14,'seed':_0xebcf24,'n_samples':0x1,'ucPreset':0x0,'uc':'lowres,\x20bad\x20anatomy,\x20bad\x20hands,\x20text,\x20error,\x20missing\x20fingers,\x20extra\x20digit,\x20fewer\x20digits,\x20cropped,\x20worst\x20quality,\x20low\x20quality,\x20normal\x20quality,\x20jpeg\x20artifacts,\x20signature,\x20watermark,\x20username,\x20blurry'})});}catch(_0x2e7a2a){console[_0x55b1('0x54')](_0x2e7a2a);_0xaf3fe9[_0x55b1('0x76')]('没有访问成功哦');kg2=0x0;return;}return;}if(!res[_0x55b1('0x72')]('event:\x20newImage')){_0xaf3fe9['reply'](_0x55b1('0x2c'));kg2=0x0;return;}res=res['replace'](/id: 1/g,'')[_0x55b1('0x6')]();res=res[_0x55b1('0x60')](/event: newImage/g,'')[_0x55b1('0x6')]();res=res['replace'](/data:/g,'')[_0x55b1('0x6')]();if(res==''){_0xaf3fe9['reply']('我没画成功，再来一次吧。');kg2=0x0;return;}await _0x151b63[_0x55b1('0x82')](_0x55b1('0x48'),res[_0x55b1('0x1b')](),'base64',_0x12d455=>{if(_0x12d455){console['log']('写入文件错误');}else{console['log']('写入文件成功');}});if(iscanshu==0x0){_0x389efc='';}msg2=[segment[_0x55b1('0x78')](ml+'/2.png'),_0x389efc];await sleep(0x1f4);let _0x44f410=await _0xaf3fe9[_0x55b1('0x76')](msg2,ishuifu);iscd=0x1;console['log'](_0x44f410[_0x55b1('0x24')],isch);if(_0x44f410&&_0x44f410['message_id']&&isch==0x1&&_0xaf3fe9['isGroup']){let _0x2fc79b=_0xaf3fe9['group'];setTimeout(()=>{_0x2fc79b['recallMsg'](_0x44f410['message_id']);},timeout);}startTimeMS=new Date()['getTime']();t=setTimeout(()=>{kg2=0x0;iscd=0x0;},cd);}else if(iscd==0x1){let _0x1cbc63=cd-(new Date()['getTime']()-startTimeMS);_0x1cbc63=Math[_0x55b1('0x26')](_0x1cbc63/0x3e8);if(_0x1cbc63<0x0){kg2=0x0;return;}_0xaf3fe9[_0x55b1('0x76')](_0x55b1('0x68')+String(_0x1cbc63)+_0x55b1('0x55'));}else{_0xaf3fe9[_0x55b1('0x76')](_0x55b1('0x18'));}}}async function imgUrlToBase64(_0x50c02d){let _0x5091b4;return new Promise(function(_0x3ca1c0,_0x4c6a13){let _0xa4ea97=http['get'](_0x50c02d,function(_0x4a1edf){var _0x139b4d=[];var _0x7e5e6=0x0;_0x4a1edf['on'](_0x55b1('0x1f'),function(_0x1f80e2){_0x139b4d['push'](_0x1f80e2);_0x7e5e6+=_0x1f80e2['length'];});_0x4a1edf['on']('end',function(_0x1a1b7b){var _0x192777=Buffer[_0x55b1('0x1c')](_0x139b4d,_0x7e5e6);_0x5091b4=_0x192777['toString'](_0x55b1('0x16'));_0x3ca1c0({'success':!![],'base64Img':_0x5091b4});});});_0xa4ea97['on'](_0x55b1('0xe'),_0xb9144c=>{_0x3ca1c0({'success':![],'errmsg':_0xb9144c[_0x55b1('0x7c')]});});_0xa4ea97[_0x55b1('0x65')]();});}function sleep(_0x10f7ab){return new Promise(_0x209eaf=>setTimeout(_0x209eaf,_0x10f7ab));}async function dqpz(){Path=ml+_0x55b1('0x57');await _0x151b63['readFile'](Path,(_0x47f2a4,_0xdd4249)=>{nr=_0xdd4249['toString']();nr=nr[_0x55b1('0x35')](',');cd=nr[0x0];timeout=nr[0x1];isch=nr[0x2];iscd=nr[0x3];console['log'](cd,timeout,isch,iscd);});await sleep(0x1f4);}async function getAgent(){let _0x313ff6=_0x332620[_0x55b1('0xd')]['proxyAddress'];if(!_0x313ff6)return null;if(_0x313ff6==='http://0.0.0.0:0')return null;if(HttpsProxyAgent===''){HttpsProxyAgent=await import(_0x55b1('0x81'))[_0x55b1('0x6b')](_0x4ee8cc=>{logger[_0x55b1('0xe')](_0x4ee8cc);});HttpsProxyAgent=HttpsProxyAgent?HttpsProxyAgent['default']:undefined;}if(HttpsProxyAgent){return new HttpsProxyAgent(_0x313ff6);}return null;}