const _0xc1ed=['\x0a降噪：','\x0a规模：','[\x5cu4E00-\x5cu9FFF]+','#新增预设','/3.jpg','文件写入成功！','写入文件错误','utf-8','getTime','/plugins/earth-k-plugin/resources/pz/pz.txt','土块AI绘个图','text','^#取消画图$|^#所有人可画$|^#仅我可画$|^#土块画图撤回(.*)$|^#土块画图冷却(.*)$|^#土块画图涩涩开启|^#土块画图涩涩关闭','ddim','push','Euler\x20a','#查看所有模型','huatu2','^#开启代理|^#关闭代理|^#开启参数显示|^#关闭参数显示|^#开启词条回复|^#关闭词条回复','开启代理成功','includes','我在cd中，还有','\x20\x0a步数:','length','readFile','error','k_euler_ancestral','trim','gjc','https-proxy-agent','好的，权限已经关闭，只有你能画了','/plugins/earth-k-plugin/resources/htys/ys.json','模型已设置为k_euler_ancestral','event:\x20newImage','proxyAddress','步数已设置为','当前屏蔽词有：','safe-diffusion','toString','#关闭代理','#土块画图冷却','name','end','当前降噪','#土块画图冷却关闭','base64','已经取消','包含中文','^#土块画图模型(.*)|^#查看所有模型','qvht','log','123','#删除屏蔽词','message','replace','30秒还未发图，以图生草已取消','#土块画图预设','ysgn','#查看魔法','test','删除预设成功','parse','http','数字超过了预设个数','k_euler','^#绘个图(.*)$|#土块画图预设(.*)$','正在查看魔法，请稍后','splice','你是主人，没有cd，欸嘿','lowres,nude,\x20bad\x20anatomy,\x20bad\x20hands,\x20text,\x20error,\x20missing\x20fingers,\x20extra\x20digit,\x20fewer\x20digits,\x20cropped,\x20worst\x20quality,\x20low\x20quality,\x20normal\x20quality,\x20jpeg\x20artifacts,\x20signature,\x20watermark,\x20username,\x20blurry,\x20owres,\x20bad\x20anatomy,\x20bad\x20hands,\x20text,\x20error,\x20missing\x20fingers,\x20extra\x20digit,\x20fewer\x20digits,\x20cropped,\x20worst\x20quality,\x20low\x20quality,\x20normal\x20quality,\x20jpeg\x20artifacts,\x20signature,\x20watermark,\x20username,\x20blurry','是英文','规模已设置为','#删除预设','post','kqdl','请发送要查看魔法的图片','当前相似度','random','#取消画图','#仅我可画','message_id','#土块画图涩涩开启','{\x22error\x22:\x22unknown\x20error\x22}','user_id','模型已设置为ddim','fanyi','Mozilla/5.0\x20(Windows\x20NT\x206.1;\x20WOW64)\x20AppleWebKit/537.36\x20(KHTML,\x20like\x20Gecko)\x20Chrome/86.0.4240.198\x20Safari/537.36','lowres,\x20bad\x20anatomy,\x20bad\x20hands,\x20text,\x20error,\x20missing\x20fingers,\x20extra\x20digit,\x20fewer\x20digits,\x20cropped,\x20worst\x20quality,\x20low\x20quality,\x20normal\x20quality,\x20jpeg\x20artifacts,\x20signature,\x20watermark,\x20username,\x20blurry','你还不可以用该功能哦','没有访问成功,尝试换接口','get','#查看预设','已关闭画图撤回','writeFile','\x20\x20\x20|规模:','好吧，那就一起来吧！','img','isMaster','url','写入文件成功','好的，已开启，请注意身体哦','#查看画图设置','huatu3','对不起，访问失败，再来一次吧','writeFileSync','isGroup','./5.png','\x20http://www.iinside.cn:7001/api_req?reqmode=nmt_mt5_jez&password=3652&text=','对不起，你不可画哦','group','recallMsg','json','#土块画图撤回关闭','round','新增屏蔽词成功','msg','findIndex','/5.png','已开启词条回复','plms','miyao','Seed','concat','删除屏蔽词成功','miyao2','已关闭画图冷却','#以图生草','abc','shuju','application/json','pbc','已设置撤回时间为','#以图生草相似度','sj2','^#土块画图步数(.*)|^#查看画图设置','data','None','^#查看所有预设$|#新增预设(.*)|(.*)','reply','#土块画图撤回','已开启画图撤回，撤回时间为30秒','/plugins/earth-k-plugin/resources/my/my.json','没有访问成功哦','stringify','split','没有这个预设哦','#关闭词条回复','以图生草暂不支持私聊','秒可画'];const _0x5d6c=function(_0xc1edac,_0x5d6ccb){_0xc1edac=_0xc1edac-0x0;let _0x473b6e=_0xc1ed[_0xc1edac];return _0x473b6e;};import{segment}from'oicq';import _0x5416f2 from'node-fetch';import _0x458dd7,{chownSync}from'fs';import _0xdc7253 from'../../../lib/config/config.js';import _0x22e507 from'../../../lib/puppeteer/puppeteer.js';let data1={};import{createRequire}from'module';import{Console}from'console';const require=createRequire(import.meta[_0x5d6c('0x62')]);let ysct;let mfkg=0x0;let ml=process['cwd']();var http=require(_0x5d6c('0x3e'));import _0x163992 from'lodash';let yushekg=0x0;let kg=0x0;let guimo=5.5;let kg2=0x0;let mfid='';let res4;let res5;let res;let zr=0x0;let changdu=0x200;let kuandu=0x200;let msg2;let timeout=0x7530;let isch=0x1;let cd=0x0;let t;let startTimeMS;let iscd=0x0;let my;let dz;let sj1;let sj2;let shuju;let zt=0x0;let gjc2;let sc=0x0;let bushu=0x1c;let id='';let xsd=0.4;let nr;let ycqx;let jz=0.2;let ss='nai-diffusion';let Path;let ys=[];let moxing='k_euler';let isdl=0x0;let iscanshu=0x1;let ishuifu=!![];let HttpsProxyAgent='';let pc=_0x5d6c('0x45');export class aiht extends plugin{constructor(){super({'name':'土块AI绘个图','dsc':_0x5d6c('0xa'),'event':'message','priority':0x479,'rule':[{'reg':_0x5d6c('0x41'),'fnc':_0x5d6c('0x11')},{'reg':_0x5d6c('0xc'),'fnc':'qvht'},{'reg':'^#新增屏蔽词(.*)$|#查看屏蔽词$|#删除屏蔽词$|#开启默认屏蔽词$','fnc':'pbc'},{'reg':'^#以图生草(.*)$|(.*)','fnc':_0x5d6c('0x66'),'log':![]},{'reg':_0x5d6c('0x89'),'fnc':_0x5d6c('0x39'),'log':![]},{'reg':'^#土块画图规模(.*)','fnc':'szgm'},{'reg':_0x5d6c('0x30'),'fnc':'szmx'},{'reg':_0x5d6c('0x86'),'fnc':'szbs'},{'reg':_0x5d6c('0x12'),'fnc':_0x5d6c('0x4a')}]});}async[_0x5d6c('0x4a')](_0x254d82){if(_0x254d82['msg']=='#开启代理'&_0x254d82[_0x5d6c('0x61')]){isdl=0x1;_0x254d82[_0x5d6c('0x8a')](_0x5d6c('0x13'));}if(_0x254d82[_0x5d6c('0x73')]==_0x5d6c('0x27')&_0x254d82[_0x5d6c('0x61')]){isdl=0x0;_0x254d82[_0x5d6c('0x8a')]('已关闭代理');}if(_0x254d82[_0x5d6c('0x73')]=='#开启参数显示'&_0x254d82['isMaster']){iscanshu=0x1;_0x254d82[_0x5d6c('0x8a')]('已开启参数显示');}if(_0x254d82['msg']=='#关闭参数显示'&_0x254d82[_0x5d6c('0x61')]){iscanshu=0x0;_0x254d82[_0x5d6c('0x8a')]('已关闭参数显示');}if(_0x254d82[_0x5d6c('0x73')]=='#开启词条回复'&_0x254d82[_0x5d6c('0x61')]){ishuifu=!![];_0x254d82['reply'](_0x5d6c('0x76'));}if(_0x254d82[_0x5d6c('0x73')]==_0x5d6c('0x92')&_0x254d82[_0x5d6c('0x61')]){ishuifu=![];_0x254d82['reply']('已关闭词条回复');}}async['szbs'](_0x2910f9){if(_0x2910f9['msg']==_0x5d6c('0x65')){console[_0x5d6c('0x32')](guimo);let _0x3e787d=['模型：',moxing,_0x5d6c('0x1'),guimo['toString'](),'\x0a步数：',bushu[_0x5d6c('0x26')](),'\x0a相似度：',xsd[_0x5d6c('0x26')](),_0x5d6c('0x0'),jz[_0x5d6c('0x26')]()];_0x2910f9['reply'](_0x3e787d);return;}bushu=_0x2910f9[_0x5d6c('0x73')][_0x5d6c('0x36')](/#土块画图步数/g,'')['trim']();bushu=Number(bushu);if(bushu<0x0|bushu>0x1c){bushu=0x1c;_0x2910f9['reply']('步数不在合理范围内，28以下为合理范围');return;}else{_0x2910f9[_0x5d6c('0x8a')](_0x5d6c('0x23')+String(bushu));}}async['szmx'](_0x360132){if(_0x360132['msg']==_0x5d6c('0x10')){let _0x5cee3b=['1：k_euler_ancestral,\x0a2：k_euler,\x0a3：k_lms,\x0a4：plms,\x0a5：ddim'];_0x360132[_0x5d6c('0x8a')](_0x5cee3b);return;}moxing=_0x360132[_0x5d6c('0x73')]['replace'](/#土块画图模型/g,'')['trim']();moxing=Number(moxing);if(moxing<0x0|moxing>0x5){_0x360132['reply']('模型不在合理范围内，1-5为合理范围');moxing=0x2;return;}if(moxing==0x1){moxing=_0x5d6c('0x1a');_0x360132['reply'](_0x5d6c('0x20'));}if(moxing==0x2){moxing=_0x5d6c('0x40');_0x360132['reply']('模型已设置为k_euler');}if(moxing==0x3){moxing='k_lms';_0x360132['reply']('模型已设置为k_lms');}if(moxing==0x4){moxing=_0x5d6c('0x77');_0x360132['reply']('模型已设置为plms');}if(moxing==0x5){moxing=_0x5d6c('0xd');_0x360132[_0x5d6c('0x8a')](_0x5d6c('0x54'));}}async['szgm'](_0x5786a3){guimo=_0x5786a3['msg']['replace'](/#土块画图规模/g,'')['trim']();guimo=Number(guimo);if(guimo<0x3|guimo>0xc){_0x5786a3['reply']('规模不在合理范围内，3-12为合理范围');guimo=5.5;return;}else{_0x5786a3['reply'](_0x5d6c('0x47')+String(guimo));}}async['ysgn'](_0x3b8998){if(yushekg==0x0&_0x3b8998[_0x5d6c('0x73')][_0x5d6c('0x14')](_0x5d6c('0x5b'))==![]&_0x3b8998['msg'][_0x5d6c('0x14')](_0x5d6c('0x3'))==![]&_0x3b8998[_0x5d6c('0x73')]['includes']('#删除预设')==![]&_0x3b8998[_0x5d6c('0x73')][_0x5d6c('0x14')]('#查看预设词条')==![]){return![];}let _0x20554a=ml+'/plugins/earth-k-plugin/resources/htys/ys.json';let _0x5e91a7='';await _0x458dd7['readFile'](_0x20554a,(_0x1f5411,_0x3181fc)=>{if(_0x1f5411)throw _0x1f5411;var _0x902e3a=_0x3181fc[_0x5d6c('0x26')]()!=''?JSON[_0x5d6c('0x3d')](_0x3181fc[_0x5d6c('0x26')]()):[];ysct='';_0x5e91a7='';shuju=_0x902e3a;for(let _0x5b62ae=0x0;_0x5b62ae<shuju[_0x5d6c('0x80')]['length'];_0x5b62ae++){_0x5e91a7=_0x5e91a7+shuju['shuju'][_0x5b62ae]['name']+',';ysct=ysct+shuju['shuju'][_0x5b62ae][_0x5d6c('0x1c')]+'++';}});await sleep(0x1f4);if(_0x3b8998[_0x5d6c('0x73')]['includes']('#查看预设词条')&_0x3b8998[_0x5d6c('0x61')]){let _0x3a5d63=_0x3b8998['msg']['replace'](/#查看预设词条/g,'')[_0x5d6c('0x1b')]();_0x3a5d63=Number(_0x3a5d63);ysct=ysct[_0x5d6c('0x90')]('++');_0x5e91a7=_0x5e91a7['split'](',');if(_0x3a5d63>ysct[_0x5d6c('0x17')]|_0x3a5d63<0x0){_0x3b8998[_0x5d6c('0x8a')](_0x5d6c('0x3f'));return;}_0x3b8998[_0x5d6c('0x8a')]([_0x5e91a7[_0x3a5d63-0x1],':',ysct[_0x3a5d63-0x1]]);ysct='';_0x5e91a7='';}if(_0x3b8998[_0x5d6c('0x73')]=='#查看预设'&_0x3b8998['isMaster']){_0x5e91a7=_0x5e91a7[_0x5d6c('0x90')](',');data1={'tplFile':'./plugins/earth-k-plugin/resources/aiht/ml.html','dz':ml,'lb':_0x5e91a7,'qsid':0x0};let _0x2b14e3=await _0x22e507['screenshot'](_0x5d6c('0x33'),{...data1});_0x3b8998[_0x5d6c('0x8a')](_0x2b14e3);return;_0x3b8998['reply']('当前预设有：\x0a'+_0x5e91a7);}if(_0x3b8998[_0x5d6c('0x73')][_0x5d6c('0x14')](_0x5d6c('0x48'))&_0x3b8998['isMaster']){let _0x312809=_0x3b8998[_0x5d6c('0x73')][_0x5d6c('0x36')](/#删除预设/g,'')['trim']();_0x312809=Number(_0x312809);if(_0x312809<shuju['shuju']['length']+0x1){shuju[_0x5d6c('0x80')][_0x5d6c('0x43')](_0x312809-0x1,0x1);var _0x931583=JSON['stringify'](shuju);}_0x458dd7['writeFile'](_0x20554a,_0x931583,function(_0x489464){if(_0x489464){console[_0x5d6c('0x19')](_0x489464);}_0x3b8998['reply'](_0x5d6c('0x3c'));});}if(_0x3b8998['msg'][_0x5d6c('0x14')](_0x5d6c('0x3'))&_0x3b8998['isMaster']&yushekg==0x0){yushekg=0x1;ys[0x0]=_0x3b8998['msg']['replace'](/#新增预设/g,'')['trim']();_0x3b8998[_0x5d6c('0x8a')]('请添加预设关键词');return;}if(yushekg==0x1&_0x3b8998['isMaster']){yushekg=0x0;ys[0x1]=_0x3b8998['msg'];let _0x227949={'name':ys[0x0],'gjc':ys[0x1]};shuju[_0x5d6c('0x80')]['push'](_0x227949);console[_0x5d6c('0x32')](shuju);var _0x931583=JSON[_0x5d6c('0x8f')](shuju);_0x458dd7[_0x5d6c('0x5d')](_0x20554a,_0x931583,_0x3e54b4=>{if(_0x3e54b4)throw _0x3e54b4;console[_0x5d6c('0x32')](_0x5d6c('0x5'));_0x3b8998[_0x5d6c('0x8a')]('新增预设成功');});return;}}async[_0x5d6c('0x82')](_0x37cdea){if(_0x37cdea[_0x5d6c('0x73')][_0x5d6c('0x14')]('#新增屏蔽词')&_0x37cdea['isMaster']){_0x37cdea[_0x5d6c('0x8a')](_0x5d6c('0x72'));pc=_0x37cdea[_0x5d6c('0x73')][_0x5d6c('0x36')](/#新增屏蔽词/g,'')[_0x5d6c('0x1b')]();}if(_0x37cdea[_0x5d6c('0x73')]=='#查看屏蔽词'&_0x37cdea['isMaster']){_0x37cdea[_0x5d6c('0x8a')]([_0x5d6c('0x24'),pc]);}if(_0x37cdea['msg']['includes'](_0x5d6c('0x34'))&_0x37cdea[_0x5d6c('0x61')]){_0x37cdea['reply'](_0x5d6c('0x7b')+'我知道你要干嘛！注意身体！');pc='';}if(_0x37cdea[_0x5d6c('0x73')][_0x5d6c('0x14')]('#开启默认屏蔽词')&_0x37cdea[_0x5d6c('0x61')]){_0x37cdea[_0x5d6c('0x8a')]('已经开启默认屏蔽词');pc=_0x5d6c('0x45');}}async[_0x5d6c('0x31')](_0x85d6){if(_0x85d6['msg']==_0x5d6c('0x51')&_0x85d6[_0x5d6c('0x61')]){_0x85d6[_0x5d6c('0x8a')](_0x5d6c('0x64'));ss='nai-diffusion';}if(_0x85d6['msg']=='#土块画图涩涩关闭'&_0x85d6[_0x5d6c('0x61')]){_0x85d6[_0x5d6c('0x8a')]('好的，已关闭了');ss=_0x5d6c('0x25');}await dqpz();if(_0x85d6[_0x5d6c('0x73')]['includes'](_0x5d6c('0x2c'))&_0x85d6[_0x5d6c('0x61')]){nr[0x3]=0x0;nr[0x0]=0x0;_0x458dd7[_0x5d6c('0x68')](Path,nr[_0x5d6c('0x26')](),'utf-8');cd=0x0;kg2=0x0;kg=0x0;sc=0x0;iscd=0x0;_0x85d6['reply'](_0x5d6c('0x7d'));return;}if(_0x85d6['msg']['includes']('#土块画图冷却开启')&_0x85d6[_0x5d6c('0x61')]){nr[0x0]=0x7530;nr[0x3]=0x1;_0x458dd7[_0x5d6c('0x68')](Path,nr['toString'](),_0x5d6c('0x7'));cd=0x7530;_0x85d6[_0x5d6c('0x8a')]('已开启画图冷却，冷却时间为30秒');return;}if(_0x85d6[_0x5d6c('0x73')]['includes'](_0x5d6c('0x28'))&_0x85d6['isMaster']){let _0xe68dcd=_0x85d6['msg'][_0x5d6c('0x36')](/#土块画图冷却/g,'')['trim']();cd=Number(_0xe68dcd)*0x3e8;nr[0x0]=cd;nr[0x3]=0x1;_0x458dd7[_0x5d6c('0x68')](Path,nr['toString'](),_0x5d6c('0x7'));_0x85d6[_0x5d6c('0x8a')]('已设置冷却时间为'+_0xe68dcd+'秒');}if(_0x85d6['msg'][_0x5d6c('0x14')](_0x5d6c('0x70'))&_0x85d6['isMaster']){nr[0x2]=0x0;_0x458dd7[_0x5d6c('0x68')](Path,nr['toString'](),_0x5d6c('0x7'));isch=0x0;_0x85d6[_0x5d6c('0x8a')](_0x5d6c('0x5c'));return;}if(_0x85d6['msg'][_0x5d6c('0x14')]('#土块画图撤回开启')&_0x85d6[_0x5d6c('0x61')]){isch=0x1;nr[0x1]=0x7530;nr[0x2]=0x1;_0x458dd7['writeFileSync'](Path,nr['toString'](),'utf-8');timeout=0x7530;_0x85d6['reply'](_0x5d6c('0x8c'));return;}if(_0x85d6[_0x5d6c('0x73')]['includes'](_0x5d6c('0x8b'))&_0x85d6[_0x5d6c('0x61')]){isch=0x1;let _0x3a1d2b=_0x85d6['msg'][_0x5d6c('0x36')](/#土块画图撤回/g,'')['trim']();timeout=Number(_0x3a1d2b)*0x3e8;nr[0x1]=timeout;nr[0x2]=0x1;_0x458dd7[_0x5d6c('0x68')](Path,nr['toString'](),'utf-8');_0x85d6['reply'](_0x5d6c('0x83')+_0x3a1d2b+'秒');}if(_0x85d6[_0x5d6c('0x73')]==_0x5d6c('0x4e')){kg=0x0;sc=0x0;zt=0x0;id='';console['log'](_0x5d6c('0x2e'));kg2=0x0;_0x85d6['reply']('已取消当前画图');}if(_0x85d6[_0x5d6c('0x73')]=='#所有人可画'&_0x85d6[_0x5d6c('0x61')]){_0x85d6[_0x5d6c('0x8a')](_0x5d6c('0x5f'));zr=0x0;}if(_0x85d6[_0x5d6c('0x73')]==_0x5d6c('0x4f')&_0x85d6['isMaster']){_0x85d6['reply'](_0x5d6c('0x1e'));zr=0x1;}}async['huatu3'](_0x506a10){if(_0x506a10['img']&zt==0x0&mfkg==0x0){return![];}if(_0x506a10[_0x5d6c('0x60')]==undefined&_0x506a10[_0x5d6c('0x73')]!=undefined){if(_0x506a10['msg']['includes'](_0x5d6c('0x7e'))==![]&_0x506a10['img']==undefined&zt==0x0&_0x506a10['msg']['includes'](_0x5d6c('0x3a'))==![]&mfkg==0x0){return![];}}if(mfkg==0x0&_0x506a10[_0x5d6c('0x73')]=='#查看魔法'){mfkg=0x1;mfid=_0x506a10[_0x5d6c('0x53')];_0x506a10['reply'](_0x5d6c('0x4b'));}if(_0x506a10['img']!=undefined&mfkg==0x1&mfid==_0x506a10['user_id']){_0x506a10['reply'](_0x5d6c('0x42'));mfkg=0x0;mfid='';let _0x1a5997='https://xiaobapi.top/api/xb/api/upload_image_tags.php?url=';console[_0x5d6c('0x32')](_0x506a10['img']);_0x1a5997=_0x1a5997+_0x506a10[_0x5d6c('0x60')][0x0];res=await _0x5416f2(_0x1a5997,{'method':_0x5d6c('0x5a'),'headers':{'Content-Type':_0x5d6c('0x81'),'User-Agent':_0x5d6c('0x56')}});let _0x45e27a=await res['json']();console['log']('魔法是：'+_0x45e27a);if(_0x45e27a!=undefined){_0x506a10['reply'](_0x45e27a['tags'],!![]);}else{_0x506a10['reply'](_0x5d6c('0x67'));mfkg=0x0;mfid='';}}if(_0x506a10[_0x5d6c('0x60')]==undefined&zt==0x1){return![];}if(_0x506a10[_0x5d6c('0x60')]==undefined&_0x506a10[_0x5d6c('0x73')]!=undefined){dqpz();if(_0x506a10[_0x5d6c('0x73')]['includes'](_0x5d6c('0x84'))&_0x506a10['isMaster']){xsd=Number(_0x506a10[_0x5d6c('0x73')][_0x5d6c('0x36')](/#以图生草相似度/g,'')['trim']())/0x64;_0x506a10[_0x5d6c('0x8a')](_0x5d6c('0x4c')+String(xsd));console['log'](xsd);return;}if(_0x506a10[_0x5d6c('0x73')]['includes']('#以图生草降噪')&_0x506a10[_0x5d6c('0x61')]){jz=Number(_0x506a10[_0x5d6c('0x73')]['replace'](/#以图生草降噪/g,'')[_0x5d6c('0x1b')]())/0x64;_0x506a10['reply'](_0x5d6c('0x2b')+String(jz));console['log'](jz);return;}if(zt==0x0&&sc==0x0&&_0x506a10[_0x5d6c('0x73')]['includes']('#以图生草')){if(_0x506a10['isPrivate']){_0x506a10[_0x5d6c('0x8a')](_0x5d6c('0x93'));return;}console[_0x5d6c('0x32')]('以图生草');id=_0x506a10[_0x5d6c('0x53')];gjc2=_0x506a10[_0x5d6c('0x73')]['replace'](/#以图生草/g,'')['trim']();var _0xbf8f8d=new RegExp('[\x5cu4E00-\x5cu9FFF]+','g');if(_0xbf8f8d[_0x5d6c('0x3b')](gjc2)){console['log']('包含中文');let _0x21e573='https://api.sdgou.cc/api/fanyi/?msg='+gjc2;let _0x41a7a4=await _0x5416f2(_0x21e573);let _0x2c3ca2=await _0x41a7a4[_0x5d6c('0xb')]();_0x2c3ca2=_0x2c3ca2['replace'](/有道翻译查询结果/g,'')[_0x5d6c('0x1b')]();_0x2c3ca2=_0x2c3ca2[_0x5d6c('0x36')](/翻译后/g,'')[_0x5d6c('0x1b')]();_0x2c3ca2=_0x2c3ca2['replace'](/翻译前/g,'')['trim']();_0x2c3ca2=_0x2c3ca2[_0x5d6c('0x36')](/：/g,'')[_0x5d6c('0x1b')]();_0x2c3ca2=_0x2c3ca2[_0x5d6c('0x36')](new RegExp(gjc2,'g'),'');gjc2=_0x2c3ca2;console[_0x5d6c('0x32')](gjc2);}else{console['log']('是英文');}zt=0x1;ycqx=setTimeout(()=>{if(zt==0x1){zt=0x0;_0x506a10[_0x5d6c('0x8a')](_0x5d6c('0x37'));return;}},0x7530);_0x506a10[_0x5d6c('0x8a')]([segment['at'](id),'请发送图片']);return;}}if(sc==0x0&_0x506a10[_0x5d6c('0x69')]&zt==0x1&_0x506a10[_0x5d6c('0x60')]!=undefined){clearTimeout(ycqx);let _0x4e6bef=ml+'/plugins/earth-k-plugin/resources/my/my.json';let _0x295fe2;await _0x458dd7[_0x5d6c('0x18')](_0x4e6bef,(_0x40a397,_0xff31d8)=>{my=JSON[_0x5d6c('0x3d')](_0xff31d8[_0x5d6c('0x26')]());dz=my[_0x5d6c('0x7c')];_0x295fe2=my['yh2'];});await sleep(0x1f4);if(_0x506a10[_0x5d6c('0x53')]==id&zt==0x1){sc=0x1;let _0x569f75=await imgUrlToBase64(_0x506a10['img'][0x0]['replace'](/https/g,_0x5d6c('0x3e'))[_0x5d6c('0x1b')]());let _0x1d139d=_0x569f75['base64Img'];let _0x5348f3=Math['floor'](Math['random']()*0xb6cff090);var _0x335ef9={'prompt':'masterpiece,\x20best\x20quality,'+gjc2,'width':0x180,'height':0x200,'scale':guimo,'sampler':moxing,'steps':0x32,'seed':_0x5348f3,'n_samples':0x1,'strength':0x1-xsd,'noise':jz,'ucPreset':0x0,'image':_0x1d139d,'uc':pc};_0x506a10['reply']('好的，我开始以图生草了');zt=0x0;try{res=await _0x5416f2(dz,{'method':'post','body':JSON['stringify'](_0x335ef9),'headers':{'Content-Type':_0x5d6c('0x81'),'User-Agent':_0x5d6c('0x56')}});}catch(_0x17c16d){console[_0x5d6c('0x32')](_0x17c16d);console[_0x5d6c('0x32')]('没有访问成功');kg=0x0;return;}let _0x5bd5a9=await res[_0x5d6c('0xb')]();_0x5bd5a9=_0x5bd5a9[_0x5d6c('0x36')](/id: 1/g,'')['trim']();_0x5bd5a9=_0x5bd5a9[_0x5d6c('0x36')](/event: newImage/g,'')[_0x5d6c('0x1b')]();_0x5bd5a9=_0x5bd5a9[_0x5d6c('0x36')](/data:/g,'')[_0x5d6c('0x1b')]();if(res==''){_0x506a10[_0x5d6c('0x8a')]('我没画成功，再来一次吧。');return;}_0x506a10[_0x5d6c('0x8a')]('成功了！');await _0x458dd7['writeFile']('./3.jpg',_0x5bd5a9['toString'](),_0x5d6c('0x2d'),_0x2d074a=>{if(_0x2d074a){console[_0x5d6c('0x32')]('写入文件错误');}else{console['log']('写入文件成功');}});msg2=[segment['at'](_0x506a10[_0x5d6c('0x53')]),segment['image'](ml+_0x5d6c('0x4'))];await sleep(0x1f4);let _0x18e430=await _0x506a10['reply'](msg2);iscd=0x1;console['log'](_0x18e430[_0x5d6c('0x50')],isch);if(_0x18e430&&_0x18e430[_0x5d6c('0x50')]&&isch==0x1&&_0x506a10[_0x5d6c('0x69')]){let _0xc13e86=_0x506a10['group'];setTimeout(()=>{_0xc13e86[_0x5d6c('0x6e')](_0x18e430['message_id']);},timeout);}startTimeMS=new Date()['getTime']();t=setTimeout(()=>{iscd=0x0;sc=0x0;id='';},cd);}}else if(_0x506a10[_0x5d6c('0x60')]==undefined&_0x506a10[_0x5d6c('0x73')]!=undefined){if(_0x506a10['msg'][_0x5d6c('0x14')]('#以图生草')){if(iscd==0x1){console[_0x5d6c('0x32')](iscd);let _0x3de62a=cd-(new Date()[_0x5d6c('0x8')]()-startTimeMS);_0x3de62a=Math[_0x5d6c('0x71')](_0x3de62a/0x3e8);if(_0x3de62a<0x0){sc=0x0;id='';return;}_0x506a10['reply'](_0x5d6c('0x15')+String(_0x3de62a)+_0x5d6c('0x94'));}else{_0x506a10[_0x5d6c('0x8a')]('正在生草中，我知道你很急，先别急');}}}}async[_0x5d6c('0x11')](_0x324591){dqpz();let _0x465bb4=ml+_0x5d6c('0x8d');let _0x43ac8f;let _0x552caf;let _0x1b899c;await _0x458dd7['readFile'](_0x465bb4,(_0x420fbb,_0x4dd51c)=>{my=JSON[_0x5d6c('0x3d')](_0x4dd51c['toString']());dz=my[_0x5d6c('0x78')];sj1=my['sj1'];sj2=my[_0x5d6c('0x85')];_0x43ac8f=my['zh'];_0x552caf=my[_0x5d6c('0x7c')];_0x1b899c=my['yh2'];});await sleep(0x1f4);if(dz==''){_0x324591['reply'](_0x5d6c('0x58'));return;}if(_0x324591[_0x5d6c('0x73')]['includes'](_0x5d6c('0x38'))&!_0x324591['isMaster']){_0x324591['reply']('你不是主人，不能用预设哦');return;}let _0x27690e;let _0x209df2;let _0x24e059;if(_0x324591['msg']['includes']('#土块画图预设')==![]){_0x24e059=_0x324591['msg']['replace'](/#绘个图/g,'')[_0x5d6c('0x1b')]();}if(kg2==0x0&_0x324591[_0x5d6c('0x69')]|_0x324591[_0x5d6c('0x61')]){if(kg2==0x1){_0x324591['reply'](_0x5d6c('0x44'));}if(zr==0x1&!_0x324591['isMaster']){_0x324591['reply'](_0x5d6c('0x6c'));return;}kg2=0x1;let _0x2ee43e=_0x24e059;var _0x9eba84=new RegExp(_0x5d6c('0x2'),'g');if(_0x9eba84['test'](_0x2ee43e)){console['log'](_0x5d6c('0x2f'));let _0x18641c='https://api.sdgou.cc/api/fanyi/?msg='+_0x2ee43e;let _0x2c3969=await _0x5416f2(_0x18641c);let _0x35ce16=await _0x2c3969['text']();_0x35ce16=_0x35ce16['replace'](/有道翻译查询结果/g,'')[_0x5d6c('0x1b')]();_0x35ce16=_0x35ce16[_0x5d6c('0x36')](/翻译后/g,'')[_0x5d6c('0x1b')]();_0x35ce16=_0x35ce16[_0x5d6c('0x36')](/翻译前/g,'')[_0x5d6c('0x1b')]();_0x35ce16=_0x35ce16['replace'](/：/g,'')['trim']();_0x35ce16=_0x35ce16[_0x5d6c('0x36')](new RegExp(_0x2ee43e,'g'),'');res4=_0x35ce16;if(res4==''){let _0x5ada24=_0x5d6c('0x6b')+_0x24e059+'&order=zh2en';res4=await _0x5416f2(_0x5ada24);res4=await res4['json']();res4=res4[_0x5d6c('0x87')];}if(res4==''){let _0x157e4a='https://api.66mz8.com/api/translation.php?info='+_0x24e059;res4=await _0x5416f2(_0x157e4a);res4=await res4[_0x5d6c('0x6f')]();res4=res4[_0x5d6c('0x55')];}console[_0x5d6c('0x32')](res4);}else{console[_0x5d6c('0x32')](_0x5d6c('0x46'));res4=_0x2ee43e;}let _0x467e87;let _0x8852cc;if(_0x324591[_0x5d6c('0x73')][_0x5d6c('0x14')](_0x5d6c('0x38'))&_0x324591[_0x5d6c('0x61')]){_0x209df2=_0x324591[_0x5d6c('0x73')][_0x5d6c('0x36')](/#土块画图预设/g,'')['trim']();let _0x15cfde=ml+_0x5d6c('0x1f');await _0x458dd7[_0x5d6c('0x18')](_0x15cfde,(_0x3c3653,_0xa953df)=>{_0x27690e=JSON['parse'](_0xa953df[_0x5d6c('0x26')]());_0x8852cc=_0x27690e[_0x5d6c('0x80')];var _0x550561=new RegExp(_0x5d6c('0x2'),'g');if(_0x550561[_0x5d6c('0x3b')](_0x209df2)){console[_0x5d6c('0x32')]('预设包含中文');_0x467e87=_0x8852cc[_0x5d6c('0x74')](_0x30b5f0=>_0x30b5f0[_0x5d6c('0x29')]==_0x209df2);}else{_0x467e87=Number(_0x209df2)-0x1;if(_0x467e87>_0x8852cc[_0x5d6c('0x17')]){_0x467e87=-0x1;return;}}});await sleep(0x1f4);console[_0x5d6c('0x32')](_0x467e87);if(_0x467e87!=-0x1){res4=_0x8852cc[_0x467e87]['gjc'];}else{_0x324591['reply'](_0x5d6c('0x91'));return;}}await sleep(0x1f4);_0x324591[_0x5d6c('0x8a')]('好的，我开始画图了，请稍等哦');let _0xca6858=Math['floor'](Math[_0x5d6c('0x4d')]()*0x2);if(_0xca6858==0x0){changdu=0x200;kuandu=0x300;}if(_0xca6858==0x1){changdu=0x300;kuandu=0x200;}console[_0x5d6c('0x32')](_0xca6858);console[_0x5d6c('0x32')](res4);var _0x240639=_0x5d6c('0x7f');var _0x404f13=[res4,pc,_0x5d6c('0x88'),_0x5d6c('0x88'),0x14,_0x5d6c('0xf'),![],![],0x1,0x1,0x7,-0x1,-0x1,0x0,0x0,0x0,![],changdu,kuandu,![],![],0.7,_0x5d6c('0x88'),![],![],null,'',_0x5d6c('0x79'),'','Steps','',!![],![],null,'',''];var _0x22c346=[res4,pc,'None',_0x5d6c('0x88'),0x1c,'Euler\x20a',![],![],0x1,0x1,0xb,-0x1,-0x1,0x0,0x0,0x0,![],0x200,0x200,![],![],0.7,_0x5d6c('0x88'),![],![],null,'',_0x5d6c('0x79'),'','Steps','',!![],![],null,'',''];let _0xbb4a2d=dz;let _0x4fbe8e=Math['floor'](Math[_0x5d6c('0x4d')]()*0xb6cff090);let _0x390e2a='模型:'+moxing+_0x5d6c('0x5e')+guimo[_0x5d6c('0x26')]()+_0x5d6c('0x16')+bushu['toString']()+'\x20\x20\x20\x20\x20\x20\x20\x20|seed:'+_0x4fbe8e[_0x5d6c('0x26')]();try{res=await _0x5416f2(_0xbb4a2d,{'method':_0x5d6c('0x49'),'agent':isdl?await getAgent():'','headers':{'Content-Type':'application/json','authorization':_0x43ac8f+'2MDQzLCJleHAiOjE2Njg4NTgwNDN9.YbBz70aDXeIwuipBzWjW-YHLToMhbAun5mQ-rGKmTR8'},'body':JSON['stringify']({'input':'masterpiece,\x20best\x20quality,\x20'+res4,'model':ss,'parameters':{'width':kuandu,'height':changdu,'scale':guimo,'sampler':moxing,'steps':bushu,'seed':_0x4fbe8e,'n_samples':0x1,'ucPreset':0x0,'uc':pc}})});console['log']('访问成功了');}catch(_0xf8cd99){console[_0x5d6c('0x32')](_0xf8cd99);console[_0x5d6c('0x32')]('没有访问成功,尝试换接口');_0xbb4a2d=_0x552caf;try{res=await _0x5416f2(_0xbb4a2d,{'method':'post','headers':{'Content-Type':'application/json','authorization':_0x1b899c},'body':JSON['stringify']({'prompt':'masterpiece,\x20best\x20quality,'+res4,'width':kuandu,'height':changdu,'scale':guimo,'sampler':moxing,'steps':0x14,'seed':_0x4fbe8e,'n_samples':0x1,'ucPreset':0x0,'uc':_0x5d6c('0x57')})});}catch(_0x9d8377){console['log'](_0x9d8377);_0x324591['reply'](_0x5d6c('0x8e'));kg2=0x0;return;}}res=await res['text']();if(res==_0x5d6c('0x52')){console[_0x5d6c('0x32')](_0x5d6c('0x59'));_0xbb4a2d=_0x552caf;try{res=await _0x5416f2(_0xbb4a2d,{'method':'post','headers':{'Content-Type':_0x5d6c('0x81'),'authorization':_0x1b899c},'body':JSON[_0x5d6c('0x8f')]({'prompt':'masterpiece,\x20best\x20quality,'+res4,'width':kuandu,'height':changdu,'scale':guimo,'sampler':_0x5d6c('0x1a'),'steps':0x14,'seed':_0x4fbe8e,'n_samples':0x1,'ucPreset':0x0,'uc':'lowres,\x20bad\x20anatomy,\x20bad\x20hands,\x20text,\x20error,\x20missing\x20fingers,\x20extra\x20digit,\x20fewer\x20digits,\x20cropped,\x20worst\x20quality,\x20low\x20quality,\x20normal\x20quality,\x20jpeg\x20artifacts,\x20signature,\x20watermark,\x20username,\x20blurry'})});}catch(_0x3eb365){console[_0x5d6c('0x32')](_0x3eb365);_0x324591[_0x5d6c('0x8a')]('没有访问成功哦');kg2=0x0;return;}return;}if(!res['includes'](_0x5d6c('0x21'))){_0x324591[_0x5d6c('0x8a')]('我没画成功，再来一次吧。');kg2=0x0;return;}res=res['replace'](/id: 1/g,'')['trim']();res=res['replace'](/event: newImage/g,'')['trim']();res=res[_0x5d6c('0x36')](/data:/g,'')['trim']();if(res==''){_0x324591['reply']('我没画成功，再来一次吧。');kg2=0x0;return;}await _0x458dd7['writeFile'](_0x5d6c('0x6a'),res['toString'](),_0x5d6c('0x2d'),_0x2590f8=>{if(_0x2590f8){console[_0x5d6c('0x32')](_0x5d6c('0x6'));}else{console[_0x5d6c('0x32')](_0x5d6c('0x63'));}});if(iscanshu==0x0){_0x390e2a='';}await sleep(0x1f4);msg2=[segment['image'](ml+_0x5d6c('0x75')),_0x390e2a];let _0x3ad94e=await _0x324591['reply'](msg2,ishuifu);iscd=0x1;console['log'](_0x3ad94e['message_id'],isch);if(_0x3ad94e&&_0x3ad94e[_0x5d6c('0x50')]&&isch==0x1&&_0x324591['isGroup']){let _0x36ea32=_0x324591[_0x5d6c('0x6d')];setTimeout(()=>{_0x36ea32[_0x5d6c('0x6e')](_0x3ad94e[_0x5d6c('0x50')]);},timeout);}startTimeMS=new Date()['getTime']();t=setTimeout(()=>{kg2=0x0;iscd=0x0;},cd);}else if(iscd==0x1){let _0x5738f9=cd-(new Date()[_0x5d6c('0x8')]()-startTimeMS);_0x5738f9=Math[_0x5d6c('0x71')](_0x5738f9/0x3e8);if(_0x5738f9<0x0){kg2=0x0;return;}_0x324591['reply']('我在cd中，还有'+String(_0x5738f9)+_0x5d6c('0x94'));}else{_0x324591['reply']('正在画图中，我知道你很急，但是你先别急。');}}}async function imgUrlToBase64(_0x4416a2){let _0x74dfb2;return new Promise(function(_0x170ada,_0x175bd0){let _0x5cba13=http[_0x5d6c('0x5a')](_0x4416a2,function(_0x1a082f){var _0x33acd0=[];var _0x3b50e8=0x0;_0x1a082f['on'](_0x5d6c('0x87'),function(_0x298e2d){_0x33acd0[_0x5d6c('0xe')](_0x298e2d);_0x3b50e8+=_0x298e2d[_0x5d6c('0x17')];});_0x1a082f['on'](_0x5d6c('0x2a'),function(_0x3f5bf4){var _0x200c31=Buffer[_0x5d6c('0x7a')](_0x33acd0,_0x3b50e8);_0x74dfb2=_0x200c31[_0x5d6c('0x26')](_0x5d6c('0x2d'));_0x170ada({'success':!![],'base64Img':_0x74dfb2});});});_0x5cba13['on'](_0x5d6c('0x19'),_0xa5351f=>{_0x170ada({'success':![],'errmsg':_0xa5351f[_0x5d6c('0x35')]});});_0x5cba13['end']();});}function sleep(_0x46d946){return new Promise(_0x3a195a=>setTimeout(_0x3a195a,_0x46d946));}async function dqpz(){Path=ml+_0x5d6c('0x9');await _0x458dd7[_0x5d6c('0x18')](Path,(_0xff4e09,_0x3bc458)=>{nr=_0x3bc458[_0x5d6c('0x26')]();nr=nr['split'](',');cd=nr[0x0];timeout=nr[0x1];isch=nr[0x2];iscd=nr[0x3];console['log'](cd,timeout,isch,iscd);});await sleep(0x1f4);}async function getAgent(){let _0x4f369c=_0xdc7253['bot'][_0x5d6c('0x22')];if(!_0x4f369c)return null;if(_0x4f369c==='http://0.0.0.0:0')return null;if(HttpsProxyAgent===''){HttpsProxyAgent=await import(_0x5d6c('0x1d'))['catch'](_0x9dc33d=>{logger[_0x5d6c('0x19')](_0x9dc33d);});HttpsProxyAgent=HttpsProxyAgent?HttpsProxyAgent['default']:undefined;}if(HttpsProxyAgent){return new HttpsProxyAgent(_0x4f369c);}return null;}