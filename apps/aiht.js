const _0x1067=['没有访问成功哦','tags','readFile','message','^#土块画图模型(.*)|^#查看所有模型','规模不在合理范围内，3-12为合理范围','getTime','#开启参数显示','name','{\x22error\x22:\x22unknown\x20error\x22}','utf-8','魔法是：','data','pbc','已设置冷却时间为','以图生草暂不支持私聊','正在查看魔法，请稍后','ysgn','k_lms','isGroup','正在生草中，我知道你很急，先别急','包含中文','shuju','预设包含中文','get','#以图生草','default','/5.png','已关闭画图冷却','#查看所有模型','^#以图生草(.*)$|(.*)','group','http','szgm','splice','步数不在合理范围内，28以下为合理范围','#新增屏蔽词','proxyAddress','replace','已设置撤回时间为','szmx','#查看画图设置','请发送要查看魔法的图片','miyao2','我在cd中，还有','lowres,\x20bad\x20anatomy,\x20bad\x20hands,\x20text,\x20error,\x20missing\x20fingers,\x20extra\x20digit,\x20fewer\x20digits,\x20cropped,\x20worst\x20quality,\x20low\x20quality,\x20normal\x20quality,\x20jpeg\x20artifacts,\x20signature,\x20watermark,\x20username,\x20blurry','text','yh2','已关闭参数显示','k_euler_ancestral','\x0a降噪：','已开启词条回复','对不起，你不可画哦','kqdl','test','#查看魔法','/plugins/earth-k-plugin/resources/htys/ys.json','我没画成功，再来一次吧。','土块AI绘个图','^#查看所有预设$|#新增预设(.*)|(.*)','lowres,nude,\x20bad\x20anatomy,\x20bad\x20hands,\x20text,\x20error,\x20missing\x20fingers,\x20extra\x20digit,\x20fewer\x20digits,\x20cropped,\x20worst\x20quality,\x20low\x20quality,\x20normal\x20quality,\x20jpeg\x20artifacts,\x20signature,\x20watermark,\x20username,\x20blurry,\x20owres,\x20bad\x20anatomy,\x20bad\x20hands,\x20text,\x20error,\x20missing\x20fingers,\x20extra\x20digit,\x20fewer\x20digits,\x20cropped,\x20worst\x20quality,\x20low\x20quality,\x20normal\x20quality,\x20jpeg\x20artifacts,\x20signature,\x20watermark,\x20username,\x20blurry','新增预设成功','删除屏蔽词成功','push','message_id','writeFileSync','includes','当前预设有：\x0a','miyao','正在画图中，我知道你很急，但是你先别急。','k_euler','已开启参数显示','isMaster','sj1','^#取消画图$|^#所有人可画$|^#仅我可画$|^#土块画图撤回(.*)$|^#土块画图冷却(.*)$|^#土块画图涩涩开启|^#土块画图涩涩关闭','好的，权限已经关闭，只有你能画了','masterpiece,\x20best\x20quality,','^#土块画图步数(.*)|^#查看画图设置','秒可画','对不起，访问失败，再来一次吧','floor','screenshot','parse','round','Mozilla/5.0\x20(Windows\x20NT\x206.1;\x20WOW64)\x20AppleWebKit/537.36\x20(KHTML,\x20like\x20Gecko)\x20Chrome/86.0.4240.198\x20Safari/537.36','开启代理成功','30秒还未发图，以图生草已取消','user_id','toString','[\x5cu4E00-\x5cu9FFF]+','length','我知道你要干嘛！注意身体！','writeFile','#删除预设','error','Euler\x20a','findIndex','规模已设置为','#新增预设','nai-diffusion','recallMsg','None','json','#土块画图冷却','已关闭词条回复','post','\x20\x20\x20|规模:','#土块画图预设','没有访问成功,尝试换接口','模型已设置为ddim','已经取消','#查看屏蔽词','plms','\x0a步数：','msg','https-proxy-agent','#开启默认屏蔽词','random','^#开启代理|^#关闭代理|^#开启参数显示|^#关闭参数显示|^#开启词条回复|^#关闭词条回复','split','你还不可以用该功能哦','reply','已关闭代理','application/json','log','isPrivate','Steps','huatu2','stringify','访问成功了','img','写入文件成功','qvht','concat','\x0a相似度：','image','#查看预设词条','#删除屏蔽词','trim','1：k_euler_ancestral,\x0a2：k_euler,\x0a3：k_lms,\x0a4：plms,\x0a5：ddim','已开启画图撤回，撤回时间为30秒','已经开启默认屏蔽词','#土块画图撤回','#以图生草相似度','已开启画图冷却，冷却时间为30秒','没有这个预设哦'];const _0x9512=function(_0x10678e,_0x95126){_0x10678e=_0x10678e-0x0;let _0x4b40ba=_0x1067[_0x10678e];return _0x4b40ba;};import{segment}from'oicq';import _0x2589fa from'node-fetch';import _0x572f18,{chownSync}from'fs';import _0x449d79 from'../../../lib/config/config.js';import _0x5dfacd from'../../../lib/puppeteer/puppeteer.js';let data1={};import{createRequire}from'module';import{Console}from'console';const require=createRequire(import.meta['url']);let ysct;let mfkg=0x0;let ml=process['cwd']();var http=require(_0x9512('0x20'));import _0x3a80e4 from'lodash';let yushekg=0x0;let kg=0x0;let guimo=5.5;let kg2=0x0;let mfid='';let res4;let res5;let res;let zr=0x0;let changdu=0x200;let kuandu=0x200;let msg2;let timeout=0x7530;let isch=0x1;let cd=0x0;let t;let startTimeMS;let iscd=0x0;let my;let dz;let sj1;let sj2;let shuju;let zt=0x0;let gjc2;let sc=0x0;let bushu=0x1c;let id='';let xsd=0.4;let nr;let ycqx;let jz=0.2;let ss=_0x9512('0x63');let Path;let ys=[];let moxing=_0x9512('0x46');let isdl=0x0;let iscanshu=0x1;let ishuifu=!![];let HttpsProxyAgent='';let pc='lowres,nude,\x20bad\x20anatomy,\x20bad\x20hands,\x20text,\x20error,\x20missing\x20fingers,\x20extra\x20digit,\x20fewer\x20digits,\x20cropped,\x20worst\x20quality,\x20low\x20quality,\x20normal\x20quality,\x20jpeg\x20artifacts,\x20signature,\x20watermark,\x20username,\x20blurry,\x20owres,\x20bad\x20anatomy,\x20bad\x20hands,\x20text,\x20error,\x20missing\x20fingers,\x20extra\x20digit,\x20fewer\x20digits,\x20cropped,\x20worst\x20quality,\x20low\x20quality,\x20normal\x20quality,\x20jpeg\x20artifacts,\x20signature,\x20watermark,\x20username,\x20blurry';export class aiht extends plugin{constructor(){super({'name':_0x9512('0x3a'),'dsc':_0x9512('0x3a'),'event':_0x9512('0x3'),'priority':0x479,'rule':[{'reg':'^#绘个图(.*)$|#土块画图预设(.*)$','fnc':_0x9512('0x7f')},{'reg':_0x9512('0x4a'),'fnc':'qvht'},{'reg':'^#新增屏蔽词(.*)$|#查看屏蔽词$|#删除屏蔽词$|#开启默认屏蔽词$','fnc':'pbc'},{'reg':_0x9512('0x1e'),'fnc':'huatu3','log':![]},{'reg':_0x9512('0x3b'),'fnc':_0x9512('0x11'),'log':![]},{'reg':'^#土块画图规模(.*)','fnc':_0x9512('0x21')},{'reg':_0x9512('0x4'),'fnc':_0x9512('0x28')},{'reg':_0x9512('0x4d'),'fnc':'szbs'},{'reg':_0x9512('0x76'),'fnc':_0x9512('0x35')}]});}async[_0x9512('0x35')](_0x4c8fd6){if(_0x4c8fd6['msg']=='#开启代理'&_0x4c8fd6['isMaster']){isdl=0x1;_0x4c8fd6[_0x9512('0x79')](_0x9512('0x55'));}if(_0x4c8fd6['msg']=='#关闭代理'&_0x4c8fd6['isMaster']){isdl=0x0;_0x4c8fd6['reply'](_0x9512('0x7a'));}if(_0x4c8fd6[_0x9512('0x72')]==_0x9512('0x7')&_0x4c8fd6['isMaster']){iscanshu=0x1;_0x4c8fd6[_0x9512('0x79')](_0x9512('0x47'));}if(_0x4c8fd6[_0x9512('0x72')]=='#关闭参数显示'&_0x4c8fd6[_0x9512('0x48')]){iscanshu=0x0;_0x4c8fd6[_0x9512('0x79')](_0x9512('0x30'));}if(_0x4c8fd6['msg']=='#开启词条回复'&_0x4c8fd6[_0x9512('0x48')]){ishuifu=!![];_0x4c8fd6['reply'](_0x9512('0x33'));}if(_0x4c8fd6[_0x9512('0x72')]=='#关闭词条回复'&_0x4c8fd6[_0x9512('0x48')]){ishuifu=![];_0x4c8fd6['reply'](_0x9512('0x68'));}}async['szbs'](_0x2a4d1b){if(_0x2a4d1b['msg']==_0x9512('0x29')){console[_0x9512('0x7c')](guimo);let _0x350299=['模型：',moxing,'\x0a规模：',guimo[_0x9512('0x58')](),_0x9512('0x71'),bushu[_0x9512('0x58')](),_0x9512('0x86'),xsd[_0x9512('0x58')](),_0x9512('0x32'),jz['toString']()];_0x2a4d1b['reply'](_0x350299);return;}bushu=_0x2a4d1b[_0x9512('0x72')][_0x9512('0x26')](/#土块画图步数/g,'')[_0x9512('0x8a')]();bushu=Number(bushu);if(bushu<0x0|bushu>0x1c){bushu=0x1c;_0x2a4d1b['reply'](_0x9512('0x23'));return;}else{_0x2a4d1b[_0x9512('0x79')]('步数已设置为'+String(bushu));}}async[_0x9512('0x28')](_0x322a24){if(_0x322a24[_0x9512('0x72')]==_0x9512('0x1d')){let _0x415eb0=[_0x9512('0x8b')];_0x322a24[_0x9512('0x79')](_0x415eb0);return;}moxing=_0x322a24['msg']['replace'](/#土块画图模型/g,'')['trim']();moxing=Number(moxing);if(moxing<0x0|moxing>0x5){_0x322a24[_0x9512('0x79')]('模型不在合理范围内，1-5为合理范围');moxing=0x2;return;}if(moxing==0x1){moxing=_0x9512('0x31');_0x322a24['reply']('模型已设置为k_euler_ancestral');}if(moxing==0x2){moxing='k_euler';_0x322a24['reply']('模型已设置为k_euler');}if(moxing==0x3){moxing=_0x9512('0x12');_0x322a24['reply']('模型已设置为k_lms');}if(moxing==0x4){moxing=_0x9512('0x70');_0x322a24['reply']('模型已设置为plms');}if(moxing==0x5){moxing='ddim';_0x322a24[_0x9512('0x79')](_0x9512('0x6d'));}}async[_0x9512('0x21')](_0x20e003){guimo=_0x20e003[_0x9512('0x72')]['replace'](/#土块画图规模/g,'')[_0x9512('0x8a')]();guimo=Number(guimo);if(guimo<0x3|guimo>0xc){_0x20e003['reply'](_0x9512('0x5'));guimo=5.5;return;}else{_0x20e003['reply'](_0x9512('0x61')+String(guimo));}}async[_0x9512('0x11')](_0x1ae3d1){if(_0x1ae3d1[_0x9512('0x82')]!=undefined){return![];}if(yushekg==0x0&_0x1ae3d1[_0x9512('0x72')]['includes']('#查看预设')==![]&_0x1ae3d1['msg']['includes']('#新增预设')==![]&_0x1ae3d1['msg']['includes']('#删除预设')==![]&_0x1ae3d1[_0x9512('0x72')][_0x9512('0x42')](_0x9512('0x88'))==![]){return![];}let _0x32dbbd=ml+_0x9512('0x38');let _0x47359e='';await _0x572f18['readFile'](_0x32dbbd,(_0x133e1b,_0xfb324e)=>{if(_0x133e1b)throw _0x133e1b;var _0x46744e=_0xfb324e['toString']()!=''?JSON[_0x9512('0x52')](_0xfb324e[_0x9512('0x58')]()):[];ysct='';_0x47359e='';shuju=_0x46744e;for(let _0x5aeb3e=0x0;_0x5aeb3e<shuju[_0x9512('0x16')]['length'];_0x5aeb3e++){_0x47359e=_0x47359e+shuju['shuju'][_0x5aeb3e][_0x9512('0x8')]+',';ysct=ysct+shuju['shuju'][_0x5aeb3e]['gjc']+'++';}});await sleep(0x1f4);if(_0x1ae3d1['msg']['includes']('#查看预设词条')&_0x1ae3d1['isMaster']){let _0x5e835c=_0x1ae3d1['msg']['replace'](/#查看预设词条/g,'')[_0x9512('0x8a')]();_0x5e835c=Number(_0x5e835c);ysct=ysct['split']('++');_0x47359e=_0x47359e[_0x9512('0x77')](',');if(_0x5e835c>ysct[_0x9512('0x5a')]|_0x5e835c<0x0){_0x1ae3d1['reply']('数字超过了预设个数');return;}_0x1ae3d1['reply']([_0x47359e[_0x5e835c-0x1],':',ysct[_0x5e835c-0x1]]);ysct='';_0x47359e='';}if(_0x1ae3d1[_0x9512('0x72')]=='#查看预设'&_0x1ae3d1[_0x9512('0x48')]){_0x47359e=_0x47359e['split'](',');data1={'tplFile':'./plugins/earth-k-plugin/resources/aiht/ml.html','dz':ml,'lb':_0x47359e,'qsid':0x0};let _0x43edcb=await _0x5dfacd[_0x9512('0x51')]('123',{...data1});_0x1ae3d1['reply'](_0x43edcb);return;_0x1ae3d1['reply'](_0x9512('0x43')+_0x47359e);}if(_0x1ae3d1[_0x9512('0x72')][_0x9512('0x42')](_0x9512('0x5d'))&_0x1ae3d1['isMaster']){let _0x192e65=_0x1ae3d1[_0x9512('0x72')]['replace'](/#删除预设/g,'')[_0x9512('0x8a')]();_0x192e65=Number(_0x192e65);if(_0x192e65<shuju[_0x9512('0x16')]['length']+0x1){shuju[_0x9512('0x16')][_0x9512('0x22')](_0x192e65-0x1,0x1);var _0x4adbd9=JSON['stringify'](shuju);}_0x572f18['writeFile'](_0x32dbbd,_0x4adbd9,function(_0x3890c6){if(_0x3890c6){console['error'](_0x3890c6);}_0x1ae3d1['reply']('删除预设成功');});}if(_0x1ae3d1[_0x9512('0x72')]['includes'](_0x9512('0x62'))&_0x1ae3d1['isMaster']&yushekg==0x0){yushekg=0x1;ys[0x0]=_0x1ae3d1[_0x9512('0x72')]['replace'](/#新增预设/g,'')['trim']();_0x1ae3d1['reply']('请添加预设关键词');return;}if(yushekg==0x1&_0x1ae3d1[_0x9512('0x48')]){yushekg=0x0;ys[0x1]=_0x1ae3d1[_0x9512('0x72')];let _0x9d197b={'name':ys[0x0],'gjc':ys[0x1]};shuju['shuju'][_0x9512('0x3f')](_0x9d197b);console[_0x9512('0x7c')](shuju);var _0x4adbd9=JSON[_0x9512('0x80')](shuju);_0x572f18[_0x9512('0x5c')](_0x32dbbd,_0x4adbd9,_0x3ed917=>{if(_0x3ed917)throw _0x3ed917;console[_0x9512('0x7c')]('文件写入成功！');_0x1ae3d1[_0x9512('0x79')](_0x9512('0x3d'));});return;}}async[_0x9512('0xd')](_0xb26846){if(_0xb26846[_0x9512('0x72')]['includes'](_0x9512('0x24'))&_0xb26846['isMaster']){_0xb26846['reply']('新增屏蔽词成功');pc=_0xb26846[_0x9512('0x72')]['replace'](/#新增屏蔽词/g,'')[_0x9512('0x8a')]();}if(_0xb26846['msg']==_0x9512('0x6f')&_0xb26846['isMaster']){_0xb26846[_0x9512('0x79')](['当前屏蔽词有：',pc]);}if(_0xb26846['msg'][_0x9512('0x42')](_0x9512('0x89'))&_0xb26846[_0x9512('0x48')]){_0xb26846[_0x9512('0x79')](_0x9512('0x3e')+_0x9512('0x5b'));pc='';}if(_0xb26846[_0x9512('0x72')]['includes'](_0x9512('0x74'))&_0xb26846[_0x9512('0x48')]){_0xb26846['reply'](_0x9512('0x8d'));pc=_0x9512('0x3c');}}async[_0x9512('0x84')](_0x308bc9){if(_0x308bc9[_0x9512('0x72')]=='#土块画图涩涩开启'&_0x308bc9[_0x9512('0x48')]){_0x308bc9[_0x9512('0x79')]('好的，已开启，请注意身体哦');ss=_0x9512('0x63');}if(_0x308bc9[_0x9512('0x72')]=='#土块画图涩涩关闭'&_0x308bc9['isMaster']){_0x308bc9['reply']('好的，已关闭了');ss='safe-diffusion';}await dqpz();if(_0x308bc9['msg'][_0x9512('0x42')]('#土块画图冷却关闭')&_0x308bc9[_0x9512('0x48')]){nr[0x3]=0x0;nr[0x0]=0x0;_0x572f18[_0x9512('0x41')](Path,nr['toString'](),'utf-8');cd=0x0;kg2=0x0;kg=0x0;sc=0x0;iscd=0x0;_0x308bc9['reply'](_0x9512('0x1c'));return;}if(_0x308bc9['msg'][_0x9512('0x42')]('#土块画图冷却开启')&_0x308bc9[_0x9512('0x48')]){nr[0x0]=0x7530;nr[0x3]=0x1;_0x572f18[_0x9512('0x41')](Path,nr['toString'](),'utf-8');cd=0x7530;_0x308bc9[_0x9512('0x79')](_0x9512('0x90'));return;}if(_0x308bc9[_0x9512('0x72')][_0x9512('0x42')](_0x9512('0x67'))&_0x308bc9[_0x9512('0x48')]){let _0x3a586f=_0x308bc9['msg']['replace'](/#土块画图冷却/g,'')['trim']();cd=Number(_0x3a586f)*0x3e8;nr[0x0]=cd;nr[0x3]=0x1;_0x572f18['writeFileSync'](Path,nr[_0x9512('0x58')](),_0x9512('0xa'));_0x308bc9[_0x9512('0x79')](_0x9512('0xe')+_0x3a586f+'秒');}if(_0x308bc9[_0x9512('0x72')][_0x9512('0x42')]('#土块画图撤回关闭')&_0x308bc9[_0x9512('0x48')]){nr[0x2]=0x0;_0x572f18[_0x9512('0x41')](Path,nr['toString'](),'utf-8');isch=0x0;_0x308bc9['reply']('已关闭画图撤回');return;}if(_0x308bc9['msg'][_0x9512('0x42')]('#土块画图撤回开启')&_0x308bc9[_0x9512('0x48')]){isch=0x1;nr[0x1]=0x7530;nr[0x2]=0x1;_0x572f18['writeFileSync'](Path,nr[_0x9512('0x58')](),_0x9512('0xa'));timeout=0x7530;_0x308bc9['reply'](_0x9512('0x8c'));return;}if(_0x308bc9['msg'][_0x9512('0x42')](_0x9512('0x8e'))&_0x308bc9[_0x9512('0x48')]){isch=0x1;let _0x26a9b6=_0x308bc9[_0x9512('0x72')][_0x9512('0x26')](/#土块画图撤回/g,'')[_0x9512('0x8a')]();timeout=Number(_0x26a9b6)*0x3e8;nr[0x1]=timeout;nr[0x2]=0x1;_0x572f18[_0x9512('0x41')](Path,nr[_0x9512('0x58')](),_0x9512('0xa'));_0x308bc9['reply'](_0x9512('0x27')+_0x26a9b6+'秒');}if(_0x308bc9['msg']=='#取消画图'){kg=0x0;sc=0x0;zt=0x0;id='';console[_0x9512('0x7c')](_0x9512('0x6e'));kg2=0x0;_0x308bc9['reply']('已取消当前画图');}if(_0x308bc9['msg']=='#所有人可画'&_0x308bc9['isMaster']){_0x308bc9['reply']('好吧，那就一起来吧！');zr=0x0;}if(_0x308bc9['msg']=='#仅我可画'&_0x308bc9['isMaster']){_0x308bc9[_0x9512('0x79')](_0x9512('0x4b'));zr=0x1;}}async['huatu3'](_0x35196f){if(_0x35196f[_0x9512('0x82')]!=undefined&zt==0x0&mfkg==0x0){return![];}if(_0x35196f['img']==undefined&_0x35196f['msg']!=undefined){if(_0x35196f['msg'][_0x9512('0x42')]('#以图生草')==![]&_0x35196f['img']==undefined&zt==0x0&_0x35196f[_0x9512('0x72')][_0x9512('0x42')](_0x9512('0x37'))==![]&mfkg==0x0){return![];}}if(mfkg==0x0&_0x35196f['msg']==_0x9512('0x37')){mfkg=0x1;mfid=_0x35196f[_0x9512('0x57')];_0x35196f['reply'](_0x9512('0x2a'));}if(_0x35196f['img']!=undefined&mfkg==0x1&mfid==_0x35196f[_0x9512('0x57')]){_0x35196f['reply'](_0x9512('0x10'));mfkg=0x0;mfid='';let _0x23be88='https://xiaobapi.top/api/xb/api/upload_image_tags.php?url=';console[_0x9512('0x7c')](_0x35196f['img']);_0x23be88=_0x23be88+_0x35196f[_0x9512('0x82')][0x0];res=await _0x2589fa(_0x23be88,{'method':'get','headers':{'Content-Type':'application/json','User-Agent':_0x9512('0x54')}});let _0x44e11e=await res['json']();console['log'](_0x9512('0xb')+_0x44e11e);if(_0x44e11e!=undefined){_0x35196f['reply'](_0x44e11e[_0x9512('0x1')],!![]);}else{_0x35196f[_0x9512('0x79')](_0x9512('0x4f'));mfkg=0x0;mfid='';}}if(_0x35196f['img']==undefined&zt==0x1){return![];}if(_0x35196f[_0x9512('0x82')]==undefined&_0x35196f['msg']!=undefined){dqpz();if(_0x35196f['msg'][_0x9512('0x42')](_0x9512('0x8f'))&_0x35196f['isMaster']){xsd=Number(_0x35196f['msg']['replace'](/#以图生草相似度/g,'')['trim']())/0x64;_0x35196f[_0x9512('0x79')]('当前相似度'+String(xsd));console['log'](xsd);return;}if(_0x35196f[_0x9512('0x72')]['includes']('#以图生草降噪')&_0x35196f[_0x9512('0x48')]){jz=Number(_0x35196f[_0x9512('0x72')][_0x9512('0x26')](/#以图生草降噪/g,'')['trim']())/0x64;_0x35196f[_0x9512('0x79')]('当前降噪'+String(jz));console[_0x9512('0x7c')](jz);return;}if(zt==0x0&&sc==0x0&&_0x35196f['msg']['includes'](_0x9512('0x19'))){if(_0x35196f[_0x9512('0x7d')]){_0x35196f[_0x9512('0x79')](_0x9512('0xf'));return;}console['log']('以图生草');id=_0x35196f['user_id'];gjc2=_0x35196f['msg'][_0x9512('0x26')](/#以图生草/g,'')['trim']();var _0x55b704=new RegExp(_0x9512('0x59'),'g');if(_0x55b704['test'](gjc2)){console['log']('包含中文');let _0x3c5e6c='https://api.sdgou.cc/api/fanyi/?msg='+gjc2;let _0x564291=await _0x2589fa(_0x3c5e6c);let _0x25bdb2=await _0x564291['text']();_0x25bdb2=_0x25bdb2['replace'](/有道翻译查询结果/g,'')[_0x9512('0x8a')]();_0x25bdb2=_0x25bdb2[_0x9512('0x26')](/翻译后/g,'')[_0x9512('0x8a')]();_0x25bdb2=_0x25bdb2['replace'](/翻译前/g,'')[_0x9512('0x8a')]();_0x25bdb2=_0x25bdb2[_0x9512('0x26')](/：/g,'')[_0x9512('0x8a')]();_0x25bdb2=_0x25bdb2['replace'](new RegExp(gjc2,'g'),'');gjc2=_0x25bdb2;console[_0x9512('0x7c')](gjc2);}else{console['log']('是英文');}zt=0x1;ycqx=setTimeout(()=>{if(zt==0x1){zt=0x0;_0x35196f[_0x9512('0x79')](_0x9512('0x56'));return;}},0x7530);_0x35196f[_0x9512('0x79')]([segment['at'](id),'请发送图片']);return;}}if(sc==0x0&_0x35196f['isGroup']&zt==0x1&_0x35196f['img']!=undefined){clearTimeout(ycqx);let _0x404a0a=ml+'/plugins/earth-k-plugin/resources/my/my.json';let _0x566676;await _0x572f18['readFile'](_0x404a0a,(_0x43afea,_0x58d6a6)=>{my=JSON['parse'](_0x58d6a6['toString']());dz=my[_0x9512('0x2b')];_0x566676=my[_0x9512('0x2f')];});await sleep(0x1f4);if(_0x35196f[_0x9512('0x57')]==id&zt==0x1){sc=0x1;let _0x34b4be=await imgUrlToBase64(_0x35196f[_0x9512('0x82')][0x0]['replace'](/https/g,'http')['trim']());let _0x17d599=_0x34b4be['base64Img'];let _0x5de586=Math['floor'](Math['random']()*0xb6cff090);var _0x18bee3={'prompt':_0x9512('0x4c')+gjc2,'width':0x180,'height':0x200,'scale':guimo,'sampler':moxing,'steps':0x32,'seed':_0x5de586,'n_samples':0x1,'strength':0x1-xsd,'noise':jz,'ucPreset':0x0,'image':_0x17d599,'uc':pc};_0x35196f['reply']('好的，我开始以图生草了');zt=0x0;try{res=await _0x2589fa(dz,{'method':_0x9512('0x69'),'body':JSON['stringify'](_0x18bee3),'headers':{'Content-Type':'application/json','User-Agent':'Mozilla/5.0\x20(Windows\x20NT\x206.1;\x20WOW64)\x20AppleWebKit/537.36\x20(KHTML,\x20like\x20Gecko)\x20Chrome/86.0.4240.198\x20Safari/537.36'}});}catch(_0x54978e){console['log'](_0x54978e);console[_0x9512('0x7c')]('没有访问成功');kg=0x0;return;}let _0x56b33c=await res['text']();_0x56b33c=_0x56b33c['replace'](/id: 1/g,'')[_0x9512('0x8a')]();_0x56b33c=_0x56b33c['replace'](/event: newImage/g,'')['trim']();_0x56b33c=_0x56b33c[_0x9512('0x26')](/data:/g,'')['trim']();if(res==''){_0x35196f['reply'](_0x9512('0x39'));return;}_0x35196f[_0x9512('0x79')]('成功了！');await _0x572f18['writeFile']('./3.jpg',_0x56b33c['toString'](),'base64',_0x299891=>{if(_0x299891){console[_0x9512('0x7c')]('写入文件错误');}else{console['log'](_0x9512('0x83'));}});msg2=[segment['at'](_0x35196f[_0x9512('0x57')]),segment['image'](ml+'/3.jpg')];await sleep(0x1f4);let _0x4aa400=await _0x35196f[_0x9512('0x79')](msg2);iscd=0x1;console['log'](_0x4aa400[_0x9512('0x40')],isch);if(_0x4aa400&&_0x4aa400[_0x9512('0x40')]&&isch==0x1&&_0x35196f['isGroup']){let _0x6af5c2=_0x35196f[_0x9512('0x1f')];setTimeout(()=>{_0x6af5c2['recallMsg'](_0x4aa400[_0x9512('0x40')]);},timeout);}startTimeMS=new Date()['getTime']();t=setTimeout(()=>{iscd=0x0;sc=0x0;id='';},cd);}}else if(_0x35196f['img']==undefined&_0x35196f[_0x9512('0x72')]!=undefined){if(_0x35196f[_0x9512('0x72')]['includes']('#以图生草')){if(iscd==0x1){console[_0x9512('0x7c')](iscd);let _0x359438=cd-(new Date()[_0x9512('0x6')]()-startTimeMS);_0x359438=Math[_0x9512('0x53')](_0x359438/0x3e8);if(_0x359438<0x0){sc=0x0;id='';return;}_0x35196f[_0x9512('0x79')]('我在cd中，还有'+String(_0x359438)+_0x9512('0x4e'));}else{_0x35196f['reply'](_0x9512('0x14'));}}}}async['huatu2'](_0x5a4ffa){dqpz();let _0x2a9cdb=ml+'/plugins/earth-k-plugin/resources/my/my.json';let _0x4fa26f;let _0x2d5d08;let _0x419ab4;await _0x572f18['readFile'](_0x2a9cdb,(_0x499938,_0x4b90db)=>{my=JSON['parse'](_0x4b90db['toString']());dz=my[_0x9512('0x44')];sj1=my[_0x9512('0x49')];sj2=my['sj2'];_0x4fa26f=my['zh'];_0x2d5d08=my['miyao2'];_0x419ab4=my[_0x9512('0x2f')];});await sleep(0x1f4);if(dz==''){_0x5a4ffa['reply'](_0x9512('0x78'));return;}if(_0x5a4ffa[_0x9512('0x72')]['includes'](_0x9512('0x6b'))&!_0x5a4ffa['isMaster']){_0x5a4ffa[_0x9512('0x79')]('你不是主人，不能用预设哦');return;}let _0x12b96e;let _0x1554ee;let _0x236aa5;if(_0x5a4ffa['msg'][_0x9512('0x42')](_0x9512('0x6b'))==![]){_0x236aa5=_0x5a4ffa[_0x9512('0x72')]['replace'](/#绘个图/g,'')[_0x9512('0x8a')]();}if(kg2==0x0&_0x5a4ffa[_0x9512('0x13')]|_0x5a4ffa[_0x9512('0x48')]){if(kg2==0x1){_0x5a4ffa[_0x9512('0x79')]('你是主人，没有cd，欸嘿');}if(zr==0x1&!_0x5a4ffa[_0x9512('0x48')]){_0x5a4ffa['reply'](_0x9512('0x34'));return;}kg2=0x1;let _0x23d920=_0x236aa5;var _0x4f0816=new RegExp('[\x5cu4E00-\x5cu9FFF]+','g');if(_0x4f0816['test'](_0x23d920)){console['log'](_0x9512('0x15'));let _0x49482f='https://api.sdgou.cc/api/fanyi/?msg='+_0x23d920;let _0x176fe2=await _0x2589fa(_0x49482f);let _0x1cf987=await _0x176fe2[_0x9512('0x2e')]();_0x1cf987=_0x1cf987[_0x9512('0x26')](/有道翻译查询结果/g,'')['trim']();_0x1cf987=_0x1cf987[_0x9512('0x26')](/翻译后/g,'')['trim']();_0x1cf987=_0x1cf987['replace'](/翻译前/g,'')[_0x9512('0x8a')]();_0x1cf987=_0x1cf987[_0x9512('0x26')](/：/g,'')['trim']();_0x1cf987=_0x1cf987['replace'](new RegExp(_0x23d920,'g'),'');res4=_0x1cf987;if(res4==''){let _0x2723a1='\x20http://www.iinside.cn:7001/api_req?reqmode=nmt_mt5_jez&password=3652&text='+_0x236aa5+'&order=zh2en';res4=await _0x2589fa(_0x2723a1);res4=await res4['json']();res4=res4['data'];}if(res4==''){let _0x4ae176='https://api.66mz8.com/api/translation.php?info='+_0x236aa5;res4=await _0x2589fa(_0x4ae176);res4=await res4[_0x9512('0x66')]();res4=res4['fanyi'];}console[_0x9512('0x7c')](res4);}else{console['log']('是英文');res4=_0x23d920;}let _0x16356a;let _0x3bf0c8;if(_0x5a4ffa[_0x9512('0x72')]['includes'](_0x9512('0x6b'))&_0x5a4ffa[_0x9512('0x48')]){_0x1554ee=_0x5a4ffa[_0x9512('0x72')][_0x9512('0x26')](/#土块画图预设/g,'')['trim']();let _0xfca8=ml+'/plugins/earth-k-plugin/resources/htys/ys.json';await _0x572f18[_0x9512('0x2')](_0xfca8,(_0x5b9254,_0x54214c)=>{_0x12b96e=JSON['parse'](_0x54214c['toString']());_0x3bf0c8=_0x12b96e['shuju'];var _0x133762=new RegExp('[\x5cu4E00-\x5cu9FFF]+','g');if(_0x133762[_0x9512('0x36')](_0x1554ee)){console['log'](_0x9512('0x17'));_0x16356a=_0x3bf0c8[_0x9512('0x60')](_0x5ea5f8=>_0x5ea5f8[_0x9512('0x8')]==_0x1554ee);}else{_0x16356a=Number(_0x1554ee)-0x1;if(_0x16356a>_0x3bf0c8['length']){_0x16356a=-0x1;return;}}});await sleep(0x1f4);console['log'](_0x16356a);if(_0x16356a!=-0x1){res4=_0x3bf0c8[_0x16356a]['gjc'];}else{_0x5a4ffa['reply'](_0x9512('0x91'));return;}}await sleep(0x1f4);_0x5a4ffa[_0x9512('0x79')]('好的，我开始画图了，请稍等哦');let _0x33dd14=Math[_0x9512('0x50')](Math['random']()*0x2);if(_0x33dd14==0x0){changdu=0x200;kuandu=0x300;}if(_0x33dd14==0x1){changdu=0x300;kuandu=0x200;}console[_0x9512('0x7c')](_0x33dd14);console['log'](res4);var _0x57d0ff='abc';var _0x309dbd=[res4,pc,'None','None',0x14,'Euler\x20a',![],![],0x1,0x1,0x7,-0x1,-0x1,0x0,0x0,0x0,![],changdu,kuandu,![],![],0.7,'None',![],![],null,'','Seed','','Steps','',!![],![],null,'',''];var _0x240a0f=[res4,pc,'None',_0x9512('0x65'),0x1c,_0x9512('0x5f'),![],![],0x1,0x1,0xb,-0x1,-0x1,0x0,0x0,0x0,![],0x200,0x200,![],![],0.7,_0x9512('0x65'),![],![],null,'','Seed','',_0x9512('0x7e'),'',!![],![],null,'',''];let _0x4123e8=dz;let _0x4317a8=Math['floor'](Math[_0x9512('0x75')]()*0xb6cff090);let _0x29c24c='模型:'+moxing+_0x9512('0x6a')+guimo[_0x9512('0x58')]()+'\x20\x0a步数:'+bushu['toString']()+'\x20\x20\x20\x20\x20\x20\x20\x20|seed:'+_0x4317a8['toString']();try{res=await _0x2589fa(_0x4123e8,{'method':_0x9512('0x69'),'agent':isdl?await getAgent():'','headers':{'Content-Type':_0x9512('0x7b'),'authorization':_0x4fa26f+'2MDQzLCJleHAiOjE2Njg4NTgwNDN9.YbBz70aDXeIwuipBzWjW-YHLToMhbAun5mQ-rGKmTR8'},'body':JSON['stringify']({'input':'masterpiece,\x20best\x20quality,\x20'+res4,'model':ss,'parameters':{'width':kuandu,'height':changdu,'scale':guimo,'sampler':moxing,'steps':bushu,'seed':_0x4317a8,'n_samples':0x1,'ucPreset':0x0,'uc':pc}})});console['log'](_0x9512('0x81'));}catch(_0x3de386){console[_0x9512('0x7c')](_0x3de386);console[_0x9512('0x7c')]('没有访问成功,尝试换接口');_0x4123e8=_0x2d5d08;try{res=await _0x2589fa(_0x4123e8,{'method':'post','headers':{'Content-Type':_0x9512('0x7b'),'authorization':_0x419ab4},'body':JSON['stringify']({'prompt':'masterpiece,\x20best\x20quality,'+res4,'width':kuandu,'height':changdu,'scale':guimo,'sampler':moxing,'steps':0x14,'seed':_0x4317a8,'n_samples':0x1,'ucPreset':0x0,'uc':_0x9512('0x2d')})});}catch(_0x244899){console['log'](_0x244899);_0x5a4ffa[_0x9512('0x79')]('没有访问成功哦');kg2=0x0;return;}}res=await res[_0x9512('0x2e')]();if(res==_0x9512('0x9')){console['log'](_0x9512('0x6c'));_0x4123e8=_0x2d5d08;try{res=await _0x2589fa(_0x4123e8,{'method':_0x9512('0x69'),'headers':{'Content-Type':'application/json','authorization':_0x419ab4},'body':JSON['stringify']({'prompt':_0x9512('0x4c')+res4,'width':kuandu,'height':changdu,'scale':guimo,'sampler':_0x9512('0x31'),'steps':0x14,'seed':_0x4317a8,'n_samples':0x1,'ucPreset':0x0,'uc':_0x9512('0x2d')})});}catch(_0x34c18c){console['log'](_0x34c18c);_0x5a4ffa[_0x9512('0x79')](_0x9512('0x0'));kg2=0x0;return;}return;}if(!res['includes']('event:\x20newImage')){_0x5a4ffa['reply'](_0x9512('0x39'));kg2=0x0;return;}res=res[_0x9512('0x26')](/id: 1/g,'')[_0x9512('0x8a')]();res=res[_0x9512('0x26')](/event: newImage/g,'')[_0x9512('0x8a')]();res=res['replace'](/data:/g,'')['trim']();if(res==''){_0x5a4ffa[_0x9512('0x79')]('我没画成功，再来一次吧。');kg2=0x0;return;}await _0x572f18['writeFile']('./5.png',res['toString'](),'base64',_0x53e322=>{if(_0x53e322){console[_0x9512('0x7c')]('写入文件错误');}else{console['log']('写入文件成功');}});if(iscanshu==0x0){_0x29c24c='';}await sleep(0x1f4);msg2=[segment[_0x9512('0x87')](ml+_0x9512('0x1b')),_0x29c24c];let _0x1f0cda=await _0x5a4ffa[_0x9512('0x79')](msg2,ishuifu);iscd=0x1;console['log'](_0x1f0cda[_0x9512('0x40')],isch);if(_0x1f0cda&&_0x1f0cda[_0x9512('0x40')]&&isch==0x1&&_0x5a4ffa[_0x9512('0x13')]){let _0x1cddd7=_0x5a4ffa[_0x9512('0x1f')];setTimeout(()=>{_0x1cddd7[_0x9512('0x64')](_0x1f0cda['message_id']);},timeout);}startTimeMS=new Date()[_0x9512('0x6')]();t=setTimeout(()=>{kg2=0x0;iscd=0x0;},cd);}else if(iscd==0x1){let _0x376d9c=cd-(new Date()['getTime']()-startTimeMS);_0x376d9c=Math['round'](_0x376d9c/0x3e8);if(_0x376d9c<0x0){kg2=0x0;return;}_0x5a4ffa['reply'](_0x9512('0x2c')+String(_0x376d9c)+'秒可画');}else{_0x5a4ffa['reply'](_0x9512('0x45'));}}}async function imgUrlToBase64(_0xe96797){let _0x583bae;return new Promise(function(_0x31dc0c,_0x5d95ad){let _0x2cdbaf=http[_0x9512('0x18')](_0xe96797,function(_0x1369b8){var _0x5196d4=[];var _0x5cc4b1=0x0;_0x1369b8['on'](_0x9512('0xc'),function(_0x203737){_0x5196d4[_0x9512('0x3f')](_0x203737);_0x5cc4b1+=_0x203737[_0x9512('0x5a')];});_0x1369b8['on']('end',function(_0x133083){var _0x232d51=Buffer[_0x9512('0x85')](_0x5196d4,_0x5cc4b1);_0x583bae=_0x232d51[_0x9512('0x58')]('base64');_0x31dc0c({'success':!![],'base64Img':_0x583bae});});});_0x2cdbaf['on'](_0x9512('0x5e'),_0x282d76=>{_0x31dc0c({'success':![],'errmsg':_0x282d76['message']});});_0x2cdbaf['end']();});}function sleep(_0x34d392){return new Promise(_0x2c0bc5=>setTimeout(_0x2c0bc5,_0x34d392));}async function dqpz(){Path=ml+'/plugins/earth-k-plugin/resources/pz/pz.txt';await _0x572f18['readFile'](Path,(_0xb00d82,_0x18bcd2)=>{nr=_0x18bcd2[_0x9512('0x58')]();nr=nr[_0x9512('0x77')](',');cd=nr[0x0];timeout=nr[0x1];isch=nr[0x2];iscd=nr[0x3];console[_0x9512('0x7c')](cd,timeout,isch,iscd);});await sleep(0x1f4);}async function getAgent(){let _0x17c4a4=_0x449d79['bot'][_0x9512('0x25')];if(!_0x17c4a4)return null;if(_0x17c4a4==='http://0.0.0.0:0')return null;if(HttpsProxyAgent===''){HttpsProxyAgent=await import(_0x9512('0x73'))['catch'](_0x45ff39=>{logger['error'](_0x45ff39);});HttpsProxyAgent=HttpsProxyAgent?HttpsProxyAgent[_0x9512('0x1a')]:undefined;}if(HttpsProxyAgent){return new HttpsProxyAgent(_0x17c4a4);}return null;}